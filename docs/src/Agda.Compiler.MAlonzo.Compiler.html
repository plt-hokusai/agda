<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Agda.Compiler.MAlonzo.Compiler</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mappend</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html"><span class="hs-identifier">Agda.Utils.Haskell.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">normalise</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.CallCompiler.html"><span class="hs-identifier">Agda.Compiler.CallCompiler</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html"><span class="hs-identifier">Agda.Compiler.Common</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Coerce.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Coerce</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Misc</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pretty.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Pretty</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Primitives</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.HaskellTypes.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.HaskellTypes</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html"><span class="hs-identifier">Agda.Compiler.MAlonzo.Pragmas</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.ToTreeless.html"><span class="hs-identifier">Agda.Compiler.ToTreeless</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Treeless.Unused.html"><span class="hs-identifier">Agda.Compiler.Treeless.Unused</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Treeless.Erase.html"><span class="hs-identifier">Agda.Compiler.Treeless.Erase</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html"><span class="hs-identifier">Agda.Compiler.Backend</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Imports.html"><span class="hs-identifier">Agda.Interaction.Imports</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.html"><span class="hs-identifier">Agda.Interaction.Options</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html"><span class="hs-identifier">Agda.Syntax.Common</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html"><span class="hs-identifier">Agda.Syntax.Abstract.Name</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html"><span class="hs-identifier">Agda.Syntax.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">I</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.Names.html"><span class="hs-identifier">Agda.Syntax.Internal.Names</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Internal.Names.html#namesIn"><span class="hs-identifier">namesIn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html"><span class="hs-identifier">Agda.Syntax.Treeless</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html"><span class="hs-identifier">Agda.Syntax.Literal</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Datatypes.html"><span class="hs-identifier">Agda.TypeChecking.Datatypes</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Primitive.html"><span class="hs-identifier">Agda.TypeChecking.Primitive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier">getBuiltinName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Reduce.html"><span class="hs-identifier">Agda.TypeChecking.Reduce</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Pretty.html"><span class="hs-identifier">Agda.TypeChecking.Pretty</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Substitute.html"><span class="hs-identifier">Agda.TypeChecking.Substitute</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Telescope.html"><span class="hs-identifier">Agda.TypeChecking.Telescope</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Warnings.html"><span class="hs-identifier">Agda.TypeChecking.Warnings</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.FileName.html"><span class="hs-identifier">Agda.Utils.FileName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.FileName.html#isNewerThan"><span class="hs-identifier">isNewerThan</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Function.html"><span class="hs-identifier">Agda.Utils.Function</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Functor.html"><span class="hs-identifier">Agda.Utils.Functor</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Float.html"><span class="hs-identifier">Agda.Utils.Float</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.IO.Directory.html"><span class="hs-identifier">Agda.Utils.IO.Directory</span></a></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html"><span class="hs-identifier">Agda.Utils.Lens</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.List.html"><span class="hs-identifier">Agda.Utils.List</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Maybe.html"><span class="hs-identifier">Agda.Utils.Maybe</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Monad.html"><span class="hs-identifier">Agda.Utils.Monad</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Pretty.html"><span class="hs-identifier">Agda.Utils.Pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier">prettyShow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">render</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Agda.Utils.IO.UTF8.html"><span class="hs-identifier">Agda.Utils.IO.UTF8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTF8</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.String.html"><span class="hs-identifier">Agda.Utils.String</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Paths_Agda.html"><span class="hs-identifier">Paths_Agda</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Agda.Utils.Impossible.html"><span class="hs-identifier">Agda.Utils.Impossible</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- The backend callbacks --------------------------------------------------</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend"><span class="hs-identifier hs-type">ghcBackend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span>
</span><span id="line-79"></span><span id="ghcBackend"><span class="annot"><span class="annottext">ghcBackend :: Backend
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend"><span class="hs-identifier hs-var hs-var">ghcBackend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend'
  GHCFlags GHCCompileEnv GHCModuleEnv GHCModule GHCDefinition
-&gt; Backend
forall opts env menv mod def.
NFData opts =&gt;
Backend' opts env menv mod def -&gt; Backend
</span><a href="Agda.Compiler.Backend.html#Backend"><span class="hs-identifier hs-var">Backend</span></a></span><span> </span><span class="annot"><span class="annottext">Backend'
  GHCFlags GHCCompileEnv GHCModuleEnv GHCModule GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-var">ghcBackend'</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-type">ghcBackend'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.Backend.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span>
</span><span id="line-82"></span><span id="ghcBackend%27"><span class="annot"><span class="annottext">ghcBackend' :: Backend'
  GHCFlags GHCCompileEnv GHCModuleEnv GHCModule GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcBackend%27"><span class="hs-identifier hs-var hs-var">ghcBackend'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend' :: forall opts env menv mod def.
String
-&gt; Maybe String
-&gt; opts
-&gt; [OptDescr (Flag opts)]
-&gt; (opts -&gt; Bool)
-&gt; (opts -&gt; TCM env)
-&gt; (env -&gt; IsMain -&gt; Map ModuleName mod -&gt; TCM ())
-&gt; (env
    -&gt; IsMain
    -&gt; ModuleName
    -&gt; Maybe String
    -&gt; TCM (Recompile menv mod))
-&gt; (env -&gt; menv -&gt; IsMain -&gt; ModuleName -&gt; [def] -&gt; TCM mod)
-&gt; (env -&gt; menv -&gt; IsMain -&gt; Definition -&gt; TCM def)
-&gt; Bool
-&gt; (QName -&gt; TCM Bool)
-&gt; Backend' opts env menv mod def
</span><a href="Agda.Compiler.Backend.html#Backend%27"><span class="hs-identifier hs-type">Backend'</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">backendName :: String
</span><a href="Agda.Compiler.Backend.html#backendName"><span class="hs-identifier hs-var">backendName</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC&quot;</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">backendVersion :: Maybe String
</span><a href="Agda.Compiler.Backend.html#backendVersion"><span class="hs-identifier hs-var">backendVersion</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">options :: GHCFlags
</span><a href="Agda.Compiler.Backend.html#options"><span class="hs-identifier hs-var">options</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-var">defaultGHCFlags</span></a></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">commandLineFlags :: [OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.Backend.html#commandLineFlags"><span class="hs-identifier hs-var">commandLineFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-var">ghcCommandLineFlags</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">isEnabled :: GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.Backend.html#isEnabled"><span class="hs-identifier hs-var">isEnabled</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var hs-var">flagGhcCompile</span></a></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">preCompile :: GHCFlags -&gt; TCM GHCCompileEnv
</span><a href="Agda.Compiler.Backend.html#preCompile"><span class="hs-identifier hs-var">preCompile</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; TCM GHCCompileEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-var">ghcPreCompile</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">postCompile :: GHCCompileEnv -&gt; IsMain -&gt; Map ModuleName GHCModule -&gt; TCM ()
</span><a href="Agda.Compiler.Backend.html#postCompile"><span class="hs-identifier hs-var">postCompile</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCCompileEnv -&gt; IsMain -&gt; Map ModuleName GHCModule -&gt; TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-var">ghcPostCompile</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">preModule :: GHCCompileEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; Maybe String
-&gt; TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.Backend.html#preModule"><span class="hs-identifier hs-var">preModule</span></a></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCCompileEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; Maybe String
-&gt; TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-var">ghcPreModule</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">postModule :: GHCCompileEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; [GHCDefinition]
-&gt; TCM GHCModule
</span><a href="Agda.Compiler.Backend.html#postModule"><span class="hs-identifier hs-var">postModule</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCCompileEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; [GHCDefinition]
-&gt; TCM GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-var">ghcPostModule</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">compileDef :: GHCCompileEnv
-&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCM GHCDefinition
</span><a href="Agda.Compiler.Backend.html#compileDef"><span class="hs-identifier hs-var">compileDef</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCCompileEnv
-&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCM GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-var">ghcCompileDef</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">scopeCheckingSuffices :: Bool
</span><a href="Agda.Compiler.Backend.html#scopeCheckingSuffices"><span class="hs-identifier hs-var">scopeCheckingSuffices</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mayEraseType :: QName -&gt; TCM Bool
</span><a href="Agda.Compiler.Backend.html#mayEraseType"><span class="hs-identifier hs-var">mayEraseType</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-var">ghcMayEraseType</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-comment">--- Command-line flags ---</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621680807754"><span id="local-6989586621680807755"></span></span><span class="hs-keyword">data</span><span> </span><span id="GHCFlags"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-var">GHCFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCFlags"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-var">GHCFlags</span></a></span></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="flagGhcCompile"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var hs-var">flagGhcCompile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcCallGhc"><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var hs-var">flagGhcCallGhc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcBin"><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var hs-var">flagGhcBin</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- ^ Use the compiler at PATH instead of &quot;ghc&quot;</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="flagGhcFlags"><span class="annot"><span class="annottext">GHCFlags -&gt; [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var hs-var">flagGhcFlags</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x. GHCFlags -&gt; Rep GHCFlags x)
-&gt; (forall x. Rep GHCFlags x -&gt; GHCFlags) -&gt; Generic GHCFlags
forall x. Rep GHCFlags x -&gt; GHCFlags
forall x. GHCFlags -&gt; Rep GHCFlags x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep GHCFlags x -&gt; GHCFlags
$cfrom :: forall x. GHCFlags -&gt; Rep GHCFlags x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680807744"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-type">defaultGHCFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-111"></span><span id="defaultGHCFlags"><span class="annot"><span class="annottext">defaultGHCFlags :: GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#defaultGHCFlags"><span class="hs-identifier hs-var hs-var">defaultGHCFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags :: Bool -&gt; Bool -&gt; Maybe String -&gt; [String] -&gt; GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcCompile :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcBin :: Maybe String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">flagGhcFlags :: [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-type">ghcCommandLineFlags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OptDescr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Interaction.Options.Base.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span id="ghcCommandLineFlags"><span class="annot"><span class="annottext">ghcCommandLineFlags :: [OptDescr (Flag GHCFlags)]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCommandLineFlags"><span class="hs-identifier hs-var hs-var">ghcCommandLineFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
-&gt; [String]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; String
-&gt; OptDescr (Flag GHCFlags)
forall a. String -&gt; [String] -&gt; ArgDescr a -&gt; String -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">]</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ghc&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">NoArg</span></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall (f :: * -&gt; *). Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621680807740"><span class="hs-identifier hs-var">enable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile program using the GHC backend&quot;</span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; [String]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; String
-&gt; OptDescr (Flag GHCFlags)
forall a. String -&gt; [String] -&gt; ArgDescr a -&gt; String -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ghc-dont-call-ghc&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Flag GHCFlags -&gt; ArgDescr (Flag GHCFlags)
forall a. a -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">NoArg</span></span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall (f :: * -&gt; *). Applicative f =&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621680807739"><span class="hs-identifier hs-var">dontCallGHC</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;don't call GHC, just write the GHC Haskell files.&quot;</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; [String]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; String
-&gt; OptDescr (Flag GHCFlags)
forall a. String -&gt; [String] -&gt; ArgDescr a -&gt; String -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ghc-flag&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Flag GHCFlags) -&gt; String -&gt; ArgDescr (Flag GHCFlags)
forall a. (String -&gt; a) -&gt; String -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">ReqArg</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Flag GHCFlags
forall (f :: * -&gt; *).
Applicative f =&gt;
String -&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621680807737"><span class="hs-identifier hs-var">ghcFlag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GHC-FLAG&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;give the flag GHC-FLAG to GHC&quot;</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
-&gt; [String]
-&gt; ArgDescr (Flag GHCFlags)
-&gt; String
-&gt; OptDescr (Flag GHCFlags)
forall a. String -&gt; [String] -&gt; ArgDescr a -&gt; String -&gt; OptDescr a
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;with-compiler&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Flag GHCFlags) -&gt; String -&gt; ArgDescr (Flag GHCFlags)
forall a. (String -&gt; a) -&gt; String -&gt; ArgDescr a
</span><span class="hs-identifier hs-var">ReqArg</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Flag GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-var">withCompilerFlag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PATH&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;use the compiler available at PATH&quot;</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621680807740"><span class="annot"><span class="annottext">enable :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621680807740"><span class="hs-identifier hs-var hs-var">enable</span></a></span></span><span>      </span><span id="local-6989586621680807735"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807735"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807735"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcCompile :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCompile"><span class="hs-identifier hs-var">flagGhcCompile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621680807739"><span class="annot"><span class="annottext">dontCallGHC :: GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621680807739"><span class="hs-identifier hs-var hs-var">dontCallGHC</span></a></span></span><span> </span><span id="local-6989586621680807734"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807734"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807734"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var">flagGhcCallGhc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-132"></span><span>    </span><span id="local-6989586621680807737"><span class="annot"><span class="annottext">ghcFlag :: String -&gt; GHCFlags -&gt; f GHCFlags
</span><a href="#local-6989586621680807737"><span class="hs-identifier hs-var hs-var">ghcFlag</span></a></span></span><span> </span><span id="local-6989586621680807733"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807733"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span id="local-6989586621680807732"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807732"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; f GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807732"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcFlags :: [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var">flagGhcFlags</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var hs-var">flagGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807732"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807733"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-type">withCompilerFlag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Interaction.Options.Base.html#Flag"><span class="hs-identifier hs-type">Flag</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span>
</span><span id="line-135"></span><span id="withCompilerFlag"><span class="annot"><span class="annottext">withCompilerFlag :: String -&gt; Flag GHCFlags
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#withCompilerFlag"><span class="hs-identifier hs-var hs-var">withCompilerFlag</span></a></span></span><span> </span><span id="local-6989586621680807731"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807731"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621680807730"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807730"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var hs-var">flagGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807730"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Flag GHCFlags
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807730"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">flagGhcBin :: Maybe String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var">flagGhcBin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807731"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-137"></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; OptM GHCFlags
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;only one compiler path allowed&quot;</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">--- Context types ---</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | The options derived from @GHCFlags@ and other shared options.</span><span>
</span><span id="line-142"></span><span class="hs-keyword">data</span><span> </span><span id="GHCOptions"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCOptions"><span class="hs-identifier hs-var">GHCOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCOptions"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCOptions"><span class="hs-identifier hs-var">GHCOptions</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="optGhcCallGhc"><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcCallGhc"><span class="hs-identifier hs-var hs-var">optGhcCallGhc</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcBin"><span class="annot"><span class="annottext">GHCOptions -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcBin"><span class="hs-identifier hs-var hs-var">optGhcBin</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-comment">-- ^ Use the compiler at PATH instead of &quot;ghc&quot;</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcFlags"><span class="annot"><span class="annottext">GHCOptions -&gt; [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcFlags"><span class="hs-identifier hs-var hs-var">optGhcFlags</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="optGhcCompileDir"><span class="annot"><span class="annottext">GHCOptions -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcCompileDir"><span class="hs-identifier hs-var hs-var">optGhcCompileDir</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Monads that can read @GHCOptions@</span><span>
</span><span id="line-151"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680808137"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ReadGHCOpts"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-var">ReadGHCOpts</span></a></span></span><span> </span><span id="local-6989586621680808137"><span class="annot"><a href="#local-6989586621680808137"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span id="askGhcOpts"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-type">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680808137"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span id="local-6989586621680807723"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807723"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807723"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621680807719"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCOptions m GHCOptions
</span><a href="#local-6989586621680807719"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCOptions m GHCOptions
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">data</span><span> </span><span id="GHCCompileEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-var">GHCCompileEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCCompileEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-var">GHCCompileEnv</span></a></span></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcCompileEnvOpts"><span class="annot"><span class="annottext">GHCCompileEnv -&gt; GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileEnvOpts"><span class="hs-identifier hs-var hs-var">ghcCompileEnvOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span id="local-6989586621680807715"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807715"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807715"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621680807712"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCCompileEnv m GHCOptions
</span><a href="#local-6989586621680807712"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCCompileEnv -&gt; GHCOptions)
-&gt; ReaderT GHCOptions m GHCOptions
-&gt; ReaderT GHCCompileEnv m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCCompileEnv -&gt; GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileEnvOpts"><span class="hs-identifier hs-var hs-var">ghcCompileEnvOpts</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCOptions m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Module compilation environment, bundling the overall</span><span>
</span><span id="line-165"></span><span class="hs-comment">--   backend session options along with the module's basic</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   readable properties.</span><span>
</span><span id="line-167"></span><span class="hs-keyword">data</span><span> </span><span id="GHCModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-var">GHCModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCModuleEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-var">GHCModuleEnv</span></a></span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcModCompileEnv"><span class="annot"><span class="annottext">GHCModuleEnv -&gt; GHCCompileEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModCompileEnv"><span class="hs-identifier hs-var hs-var">ghcModCompileEnv</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcModHsModuleEnv"><span class="annot"><span class="annottext">GHCModuleEnv -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModHsModuleEnv"><span class="hs-identifier hs-var hs-var">ghcModHsModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-type">HsModuleEnv</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span id="local-6989586621680807707"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807707"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807707"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621680807704"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCModuleEnv m GHCOptions
</span><a href="#local-6989586621680807704"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; GHCCompileEnv)
-&gt; ReaderT GHCCompileEnv m GHCOptions
-&gt; ReaderT GHCModuleEnv m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; GHCCompileEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModCompileEnv"><span class="hs-identifier hs-var hs-var">ghcModCompileEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCCompileEnv m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621680807703"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807703"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadHsModuleEnv"><span class="hs-identifier hs-type">ReadHsModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807703"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621680807699"><span class="annot"><span class="annottext">askHsModuleEnv :: ReaderT GHCModuleEnv m HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askHsModuleEnv"><span class="hs-identifier hs-var hs-var hs-var hs-var">askHsModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; HsModuleEnv)
-&gt; ReaderT HsModuleEnv m HsModuleEnv
-&gt; ReaderT GHCModuleEnv m HsModuleEnv
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModHsModuleEnv"><span class="hs-identifier hs-var hs-var">ghcModHsModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv m HsModuleEnv
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askHsModuleEnv"><span class="hs-identifier hs-var">askHsModuleEnv</span></a></span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-keyword">data</span><span> </span><span id="GHCModule"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCModule"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcModEnv"><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModEnv"><span class="hs-identifier hs-var hs-var">ghcModEnv</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcModMainFuncs"><span class="annot"><span class="annottext">GHCModule -&gt; [MainFunctionDef]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModMainFuncs"><span class="hs-identifier hs-var hs-var">ghcModMainFuncs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#MainFunctionDef"><span class="hs-identifier hs-type">MainFunctionDef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- ^ The `main` function definition(s), if both the module is</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-comment">--   the @IsMain@ module (root/focused) and a suitable `main`</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">--   function was defined.</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span id="local-6989586621680807694"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807694"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807694"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621680807691"><span class="annot"><span class="annottext">askGhcOpts :: ReaderT GHCModule m GHCOptions
</span><a href="#local-6989586621680807691"><span class="hs-identifier hs-var hs-var hs-var hs-var">askGhcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; GHCModuleEnv)
-&gt; ReaderT GHCModuleEnv m GHCOptions
-&gt; ReaderT GHCModule m GHCOptions
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModEnv"><span class="hs-identifier hs-var hs-var">ghcModEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621680807690"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807690"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadHsModuleEnv"><span class="hs-identifier hs-type">ReadHsModuleEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807690"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621680807687"><span class="annot"><span class="annottext">askHsModuleEnv :: ReaderT GHCModule m HsModuleEnv
</span><a href="#local-6989586621680807687"><span class="hs-identifier hs-var hs-var hs-var hs-var">askHsModuleEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; GHCModuleEnv)
-&gt; ReaderT GHCModuleEnv m HsModuleEnv
-&gt; ReaderT GHCModule m HsModuleEnv
forall r' r (m :: * -&gt; *) a.
(r' -&gt; r) -&gt; ReaderT r m a -&gt; ReaderT r' m a
</span><span class="hs-identifier hs-var">withReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModEnv"><span class="hs-identifier hs-var hs-var">ghcModEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv m HsModuleEnv
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#askHsModuleEnv"><span class="hs-identifier hs-var">askHsModuleEnv</span></a></span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">data</span><span> </span><span id="GHCDefinition"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GHCDefinition"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="ghcDefUsesFloat"><span class="annot"><span class="annottext">GHCDefinition -&gt; UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefUsesFloat"><span class="hs-identifier hs-var hs-var">ghcDefUsesFloat</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefDecls"><span class="annot"><span class="annottext">GHCDefinition -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefDecls"><span class="hs-identifier hs-var hs-var">ghcDefDecls</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefDefinition"><span class="annot"><span class="annottext">GHCDefinition -&gt; Definition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefDefinition"><span class="hs-identifier hs-var hs-var">ghcDefDefinition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefMainDef"><span class="annot"><span class="annottext">GHCDefinition -&gt; Maybe MainFunctionDef
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefMainDef"><span class="hs-identifier hs-var hs-var">ghcDefMainDef</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#MainFunctionDef"><span class="hs-identifier hs-type">MainFunctionDef</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ghcDefImports"><span class="annot"><span class="annottext">GHCDefinition -&gt; Set ModuleName
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcDefImports"><span class="hs-identifier hs-var hs-var">ghcDefImports</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">--- Top-level compilation ---</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-type">ghcPreCompile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCFlags"><span class="hs-identifier hs-type">GHCFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span>
</span><span id="line-203"></span><span id="ghcPreCompile"><span class="annot"><span class="annottext">ghcPreCompile :: GHCFlags -&gt; TCM GHCCompileEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreCompile"><span class="hs-identifier hs-var hs-var">ghcPreCompile</span></a></span></span><span> </span><span id="local-6989586621680807680"><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807680"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621680807679"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807679"><span class="hs-identifier hs-var">outDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO String
forall (m :: * -&gt; *). HasOptions m =&gt; m String
</span><a href="Agda.Compiler.Common.html#compileDir"><span class="hs-identifier hs-var">compileDir</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807677"><span class="annot"><span class="annottext">ghcOpts :: GHCOptions
</span><a href="#local-6989586621680807677"><span class="hs-identifier hs-var hs-var">ghcOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions :: Bool -&gt; String -&gt; [String] -&gt; String -&gt; GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCOptions"><span class="hs-identifier hs-type">GHCOptions</span></a></span><span>
</span><span id="line-206"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">optGhcCallGhc :: Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcCallGhc"><span class="hs-identifier hs-var">optGhcCallGhc</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcCallGhc"><span class="hs-identifier hs-var hs-var">flagGhcCallGhc</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807680"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-207"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcBin :: String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcBin"><span class="hs-identifier hs-var">optGhcBin</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ghc&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GHCFlags -&gt; Maybe String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcBin"><span class="hs-identifier hs-var hs-var">flagGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807680"><span class="hs-identifier hs-var">flags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcFlags :: [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcFlags"><span class="hs-identifier hs-var">optGhcFlags</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCFlags -&gt; [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#flagGhcFlags"><span class="hs-identifier hs-var hs-var">flagGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCFlags
</span><a href="#local-6989586621680807680"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-209"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">optGhcCompileDir :: String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcCompileDir"><span class="hs-identifier hs-var">optGhcCompileDir</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807679"><span class="hs-identifier hs-var">outDir</span></a></span><span>
</span><span id="line-210"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><span class="annottext">GHCCompileEnv -&gt; TCM GHCCompileEnv
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(GHCCompileEnv -&gt; TCM GHCCompileEnv)
-&gt; GHCCompileEnv -&gt; TCM GHCCompileEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; GHCCompileEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-var">GHCCompileEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621680807677"><span class="hs-identifier hs-var">ghcOpts</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-type">ghcPostCompile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span id="ghcPostCompile"><span class="annot"><span class="annottext">ghcPostCompile :: GHCCompileEnv -&gt; IsMain -&gt; Map ModuleName GHCModule -&gt; TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostCompile"><span class="hs-identifier hs-var hs-var">ghcPostCompile</span></a></span></span><span> </span><span id="local-6989586621680807675"><span class="annot"><span class="annottext">GHCCompileEnv
</span><a href="#local-6989586621680807675"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621680807674"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621680807674"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621680807673"><span class="annot"><span class="annottext">Map ModuleName GHCModule
</span><a href="#local-6989586621680807673"><span class="hs-identifier hs-var">mods</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- FIXME: @curMName@ and @curIF@ are evil TCM state, but there does not appear to be</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-comment">--------- another way to retrieve the compilation root (&quot;main&quot; module or interaction focused).</span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621680807672"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807672"><span class="hs-identifier hs-var">rootModuleName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO ModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m ModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621680807670"><span class="annot"><span class="annottext">GHCModule
</span><a href="#local-6989586621680807670"><span class="hs-identifier hs-var">rootModule</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe GHCModule
-&gt; (GHCModule -&gt; TCM GHCModule) -&gt; TCM GHCModule -&gt; TCM GHCModule
forall a b. Maybe a -&gt; (a -&gt; b) -&gt; b -&gt; b
</span><a href="Agda.Utils.Maybe.html#ifJust"><span class="hs-identifier hs-var">ifJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Map ModuleName GHCModule -&gt; Maybe GHCModule
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807672"><span class="hs-identifier hs-var">rootModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">Map ModuleName GHCModule
</span><a href="#local-6989586621680807673"><span class="hs-identifier hs-var">mods</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; TCM GHCModule
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-219"></span><span>                </span><span class="annot"><span class="annottext">(TCM GHCModule -&gt; TCM GHCModule) -&gt; TCM GHCModule -&gt; TCM GHCModule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; TCM GHCModule
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
String -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#genericError"><span class="hs-identifier hs-var">genericError</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TCM GHCModule) -&gt; String -&gt; TCM GHCModule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Module &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807672"><span class="hs-identifier hs-var">rootModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; was not compiled!&quot;</span></span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="annottext">(ReaderT GHCModule TCM () -&gt; GHCModule -&gt; TCM ())
-&gt; GHCModule -&gt; ReaderT GHCModule TCM () -&gt; TCM ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM () -&gt; GHCModule -&gt; TCM ()
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModule
</span><a href="#local-6989586621680807670"><span class="hs-identifier hs-var">rootModule</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModule TCM () -&gt; TCM ())
-&gt; ReaderT GHCModule TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ()
forall (m :: * -&gt; *). MonadGHCIO m =&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-var">copyRTEModules</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-var">callGHC</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">--- Module compilation ---</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-type">ghcPreModule</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span>      </span><span class="hs-comment">-- ^ Are we looking at the main module?</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>    </span><span class="hs-comment">-- ^ Path to the @.agdai@ file.</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.Backend.html#Recompile"><span class="hs-identifier hs-type">Recompile</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>                 </span><span class="hs-comment">-- ^ Could we confirm the existence of a main function?</span><span>
</span><span id="line-233"></span><span id="ghcPreModule"><span class="annot"><span class="annottext">ghcPreModule :: GHCCompileEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; Maybe String
-&gt; TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPreModule"><span class="hs-identifier hs-var hs-var">ghcPreModule</span></a></span></span><span> </span><span id="local-6989586621680807662"><span class="annot"><span class="annottext">GHCCompileEnv
</span><a href="#local-6989586621680807662"><span class="hs-identifier hs-var">cenv</span></a></span></span><span> </span><span id="local-6989586621680807661"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621680807661"><span class="hs-identifier hs-var">isMain</span></a></span></span><span> </span><span id="local-6989586621680807660"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807660"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680807659"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680807659"><span class="hs-identifier hs-var">mifile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
</span><a href="#local-6989586621680807657"><span class="hs-identifier hs-var">uptodate</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall menv. ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621680807656"><span class="hs-identifier hs-var">noComp</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621680807655"><span class="hs-identifier hs-var">yesComp</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
-&gt; GHCModuleEnv -&gt; TCM (Recompile GHCModuleEnv GHCModule)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-operator hs-var hs-var">`runReaderT`</span></span><span> </span><span class="annot"><span class="annottext">GHCCompileEnv -&gt; HsModuleEnv -&gt; GHCModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-var">GHCModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GHCCompileEnv
</span><a href="#local-6989586621680807662"><span class="hs-identifier hs-var">cenv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Misc.html#HsModuleEnv"><span class="hs-identifier hs-var">HsModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807660"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621680807661"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="annot"><span class="annottext">IsMain -&gt; IsMain -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">IsMain
</span><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-var">IsMain</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621680807657"><span class="annot"><span class="annottext">uptodate :: ReaderT GHCModuleEnv TCM Bool
</span><a href="#local-6989586621680807657"><span class="hs-identifier hs-var hs-var">uptodate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680807659"><span class="hs-identifier hs-var">mifile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReaderT GHCModuleEnv TCM Bool
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807652"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807652"><span class="hs-identifier hs-var">ifile</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; ReaderT GHCModuleEnv TCM Bool
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; ReaderT GHCModuleEnv TCM Bool)
-&gt; ReaderT GHCModuleEnv TCM (IO Bool)
-&gt; ReaderT GHCModuleEnv TCM Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO Bool
</span><a href="Agda.Utils.FileName.html#isNewerThan"><span class="hs-identifier hs-var">isNewerThan</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; IO Bool)
-&gt; ReaderT GHCModuleEnv TCM String
-&gt; ReaderT GHCModuleEnv TCM (String -&gt; IO Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM String
forall (m :: * -&gt; *). (MonadGHCIO m, ReadHsModuleEnv m) =&gt; m String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var">curOutFile</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM (String -&gt; IO Bool)
-&gt; ReaderT GHCModuleEnv TCM String
-&gt; ReaderT GHCModuleEnv TCM (IO Bool)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReaderT GHCModuleEnv TCM String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807652"><span class="hs-identifier hs-var">ifile</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span id="local-6989586621680807647"><span class="annot"><span class="annottext">ifileDesc :: String
</span><a href="#local-6989586621680807647"><span class="hs-identifier hs-var hs-var">ifileDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(memory)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680807659"><span class="hs-identifier hs-var">mifile</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621680807656"><span class="annot"><span class="annottext">noComp :: ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
</span><a href="#local-6989586621680807656"><span class="hs-identifier hs-var hs-var">noComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; String -&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; VerboseLevel -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile.ghc&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; (ModuleName -&gt; String)
-&gt; ModuleName
-&gt; ReaderT GHCModuleEnv TCM ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; : no compilation is needed.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String)
-&gt; (ModuleName -&gt; String) -&gt; ModuleName -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; String) -&gt; (ModuleName -&gt; QName) -&gt; ModuleName -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#mnameToConcrete"><span class="hs-identifier hs-var">A.mnameToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; ReaderT GHCModuleEnv TCM ModuleName
-&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM ModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m ModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span id="local-6989586621680807643"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621680807643"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM GHCModuleEnv
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-244"></span><span>      </span><span id="local-6989586621680807642"><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621680807642"><span class="hs-identifier hs-var">mainDefs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Bool
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-var">curIsMainModule</span></a></span><span>
</span><span id="line-245"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Interface -&gt; [MainFunctionDef]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#mainFunctionDefs"><span class="hs-identifier hs-var">mainFunctionDefs</span></a></span><span> </span><span class="annot"><span class="annottext">(Interface -&gt; [MainFunctionDef])
-&gt; ReaderT GHCModuleEnv TCM Interface
-&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM Interface
forall (m :: * -&gt; *). ReadTCState m =&gt; m Interface
</span><a href="Agda.Compiler.Common.html#curIF"><span class="hs-identifier hs-var">curIF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MainFunctionDef] -&gt; ReaderT GHCModuleEnv TCM [MainFunctionDef]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">Recompile menv GHCModule
-&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Recompile menv GHCModule
 -&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule))
-&gt; (GHCModule -&gt; Recompile menv GHCModule)
-&gt; GHCModule
-&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; Recompile menv GHCModule
forall menv mod. mod -&gt; Recompile menv mod
</span><a href="Agda.Compiler.Backend.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule))
-&gt; GHCModule -&gt; ReaderT GHCModuleEnv TCM (Recompile menv GHCModule)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; [MainFunctionDef] -&gt; GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621680807643"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621680807642"><span class="hs-identifier hs-var">mainDefs</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621680807655"><span class="annot"><span class="annottext">yesComp :: ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
</span><a href="#local-6989586621680807655"><span class="hs-identifier hs-var hs-var">yesComp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621680807637"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807637"><span class="hs-identifier hs-var">m</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; String) -&gt; (ModuleName -&gt; QName) -&gt; ModuleName -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; QName
</span><a href="Agda.Syntax.Abstract.Name.html#mnameToConcrete"><span class="hs-identifier hs-var">A.mnameToConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; String)
-&gt; ReaderT GHCModuleEnv TCM ModuleName
-&gt; ReaderT GHCModuleEnv TCM String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM ModuleName
forall (m :: * -&gt; *). ReadTCState m =&gt; m ModuleName
</span><a href="Agda.Compiler.Common.html#curMName"><span class="hs-identifier hs-var">curMName</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span id="local-6989586621680807636"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807636"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM String
forall (m :: * -&gt; *). (MonadGHCIO m, ReadHsModuleEnv m) =&gt; m String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var">curOutFile</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; String -&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; VerboseLevel -&gt; String -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSLn"><span class="hs-identifier hs-var">reportSLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile.ghc&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; String -&gt; ReaderT GHCModuleEnv TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String -&gt; String
</span><a href="Agda.Compiler.Common.html#repl"><span class="hs-identifier hs-var">repl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807637"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807647"><span class="hs-identifier hs-var">ifileDesc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807636"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compiling &lt;&lt;0&gt;&gt; in &lt;&lt;1&gt;&gt; to &lt;&lt;2&gt;&gt;&quot;</span></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><span class="annottext">(GHCModuleEnv -&gt; Recompile GHCModuleEnv GHCModule)
-&gt; ReaderT GHCModuleEnv TCM (Recompile GHCModuleEnv GHCModule)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; Recompile GHCModuleEnv GHCModule
forall menv mod. menv -&gt; Recompile menv mod
</span><a href="Agda.Compiler.Backend.html#Recompile"><span class="hs-identifier hs-var">Recompile</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-type">ghcPostModule</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span>        </span><span class="hs-comment">-- ^ Are we looking at the main module?</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ Compiled module content.</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span>
</span><span id="line-262"></span><span id="ghcPostModule"><span class="annot"><span class="annottext">ghcPostModule :: GHCCompileEnv
-&gt; GHCModuleEnv
-&gt; IsMain
-&gt; ModuleName
-&gt; [GHCDefinition]
-&gt; TCM GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcPostModule"><span class="hs-identifier hs-var hs-var">ghcPostModule</span></a></span></span><span> </span><span id="local-6989586621680807632"><span class="annot"><span class="annottext">GHCCompileEnv
</span><a href="#local-6989586621680807632"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621680807631"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621680807631"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span id="local-6989586621680807630"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621680807630"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621680807629"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807629"><span class="hs-identifier hs-var">_moduleName</span></a></span></span><span> </span><span id="local-6989586621680807628"><span class="annot"><span class="annottext">[GHCDefinition]
</span><a href="#local-6989586621680807628"><span class="hs-identifier hs-var">ghcDefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621680807627"><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621680807627"><span class="hs-identifier hs-var">builtinThings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TCState -&gt; BuiltinThings PrimFun)
-&gt; TCMT IO (BuiltinThings PrimFun)
forall (m :: * -&gt; *) a. ReadTCState m =&gt; (TCState -&gt; a) -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#getsTC"><span class="hs-identifier hs-var">getsTC</span></a></span><span> </span><span class="annot"><span class="annottext">TCState -&gt; BuiltinThings PrimFun
</span><a href="Agda.TypeChecking.Monad.Base.html#stBuiltinThings"><span class="hs-identifier hs-var">stBuiltinThings</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- Accumulate all of the modules, definitions, declarations, etc.</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680807624"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807624"><span class="hs-identifier hs-var">usedFloat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807623"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807623"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807622"><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680807622"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807621"><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621680807621"><span class="hs-identifier hs-var">mainDefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807620"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807620"><span class="hs-identifier hs-var">usedModules</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(UsesFloat, [Decl], [Definition], [MainFunctionDef],
  Set ModuleName)]
-&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
    Set ModuleName)
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="annot"><span class="annottext">([(UsesFloat, [Decl], [Definition], [MainFunctionDef],
   Set ModuleName)]
 -&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName))
-&gt; [(UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName)]
-&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
    Set ModuleName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-267"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span> </span><span id="local-6989586621680807619"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807619"><span class="hs-identifier hs-var">useFloat'</span></a></span></span><span> </span><span id="local-6989586621680807618"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807618"><span class="hs-identifier hs-var">decls'</span></a></span></span><span> </span><span id="local-6989586621680807617"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807617"><span class="hs-identifier hs-var">def'</span></a></span></span><span> </span><span id="local-6989586621680807616"><span class="annot"><span class="annottext">Maybe MainFunctionDef
</span><a href="#local-6989586621680807616"><span class="hs-identifier hs-var">md'</span></a></span></span><span> </span><span id="local-6989586621680807615"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807615"><span class="hs-identifier hs-var">imps'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807619"><span class="hs-identifier hs-var">useFloat'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807618"><span class="hs-identifier hs-var">decls'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807617"><span class="hs-identifier hs-var">def'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe MainFunctionDef -&gt; [MainFunctionDef]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">Maybe MainFunctionDef
</span><a href="#local-6989586621680807616"><span class="hs-identifier hs-var">md'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807615"><span class="hs-identifier hs-var">imps'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">(GHCDefinition
 -&gt; (UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName))
-&gt; [GHCDefinition]
-&gt; [(UsesFloat, [Decl], [Definition], [MainFunctionDef],
     Set ModuleName)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[GHCDefinition]
</span><a href="#local-6989586621680807628"><span class="hs-identifier hs-var">ghcDefs</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807613"><span class="annot"><span class="annottext">imps :: [ImportDecl]
</span><a href="#local-6989586621680807613"><span class="hs-identifier hs-var hs-var">imps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-var">mazRTEFloatImport</span></a></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807624"><span class="hs-identifier hs-var">usedFloat</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDecl] -&gt; [ImportDecl] -&gt; [ImportDecl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun
-&gt; Set ModuleName -&gt; [Definition] -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#imports"><span class="hs-identifier hs-var">imports</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621680807627"><span class="hs-identifier hs-var">builtinThings</span></a></span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807620"><span class="hs-identifier hs-var">usedModules</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680807622"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621680807610"><span class="annot"><span class="annottext">Interface
</span><a href="#local-6989586621680807610"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO Interface
forall (m :: * -&gt; *). ReadTCState m =&gt; m Interface
</span><a href="Agda.Compiler.Common.html#curIF"><span class="hs-identifier hs-var">curIF</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">-- Get content of FOREIGN pragmas.</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680807609"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807609"><span class="hs-identifier hs-var">headerPragmas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807608"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807608"><span class="hs-identifier hs-var">hsImps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807607"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807607"><span class="hs-identifier hs-var">code</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Interface -&gt; ([String], [String], [String])
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#foreignHaskell"><span class="hs-identifier hs-var">foreignHaskell</span></a></span><span> </span><span class="annot"><span class="annottext">Interface
</span><a href="#local-6989586621680807610"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv TCM () -&gt; GHCModuleEnv -&gt; TCM ())
-&gt; GHCModuleEnv -&gt; ReaderT GHCModuleEnv TCM () -&gt; TCM ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM () -&gt; GHCModuleEnv -&gt; TCM ()
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621680807631"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModuleEnv TCM () -&gt; TCM ())
-&gt; ReaderT GHCModuleEnv TCM () -&gt; TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621680807605"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807605"><span class="hs-identifier hs-var">hsModuleName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModuleEnv TCM ModuleName
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var">curHsMod</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">Module -&gt; ReaderT GHCModuleEnv TCM ()
forall (m :: * -&gt; *). MonadGHCIO m =&gt; Module -&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-var">writeModule</span></a></span><span> </span><span class="annot"><span class="annottext">(Module -&gt; ReaderT GHCModuleEnv TCM ())
-&gt; Module -&gt; ReaderT GHCModuleEnv TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [ModulePragma] -&gt; [ImportDecl] -&gt; [Decl] -&gt; Module
</span><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-var">HS.Module</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807605"><span class="hs-identifier hs-var">hsModuleName</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; ModulePragma) -&gt; [String] -&gt; [ModulePragma]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ModulePragma
</span><a href="Agda.Utils.Haskell.Syntax.html#OtherPragma"><span class="hs-identifier hs-var">HS.OtherPragma</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807609"><span class="hs-identifier hs-var">headerPragmas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621680807613"><span class="hs-identifier hs-var">imps</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Decl) -&gt; [String] -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeDecl"><span class="hs-identifier hs-var">fakeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807608"><span class="hs-identifier hs-var">hsImps</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807607"><span class="hs-identifier hs-var">code</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807623"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="annottext">GHCModule -&gt; TCM GHCModule
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; TCM GHCModule) -&gt; GHCModule -&gt; TCM GHCModule
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; [MainFunctionDef] -&gt; GHCModule
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-var">GHCModule</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621680807631"><span class="hs-identifier hs-var">menv</span></a></span><span> </span><span class="annot"><span class="annottext">[MainFunctionDef]
</span><a href="#local-6989586621680807621"><span class="hs-identifier hs-var">mainDefs</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-type">ghcCompileDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCCompileEnv"><span class="hs-identifier hs-type">GHCCompileEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModuleEnv"><span class="hs-identifier hs-type">GHCModuleEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.Common.html#IsMain"><span class="hs-identifier hs-type">IsMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-type">GHCDefinition</span></a></span><span>
</span><span id="line-289"></span><span id="ghcCompileDef"><span class="annot"><span class="annottext">ghcCompileDef :: GHCCompileEnv
-&gt; GHCModuleEnv -&gt; IsMain -&gt; Definition -&gt; TCM GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcCompileDef"><span class="hs-identifier hs-var hs-var">ghcCompileDef</span></a></span></span><span> </span><span id="local-6989586621680807599"><span class="annot"><span class="annottext">GHCCompileEnv
</span><a href="#local-6989586621680807599"><span class="hs-identifier hs-var">_cenv</span></a></span></span><span> </span><span id="local-6989586621680807598"><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621680807598"><span class="hs-identifier hs-var">menv</span></a></span></span><span> </span><span id="local-6989586621680807597"><span class="annot"><span class="annottext">IsMain
</span><a href="#local-6989586621680807597"><span class="hs-identifier hs-var">_isMain</span></a></span></span><span> </span><span id="local-6989586621680807596"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807596"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680807595"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807595"><span class="hs-identifier hs-var">usesFloat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807594"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807594"><span class="hs-identifier hs-var">decls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807593"><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621680807593"><span class="hs-identifier hs-var">mainFuncDef</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileState"><span class="hs-identifier hs-type">HsCompileState</span></a></span><span> </span><span id="local-6989586621680807591"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807591"><span class="hs-identifier hs-var">imps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807596"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
-&gt; HsModuleEnv
-&gt; TCM
     ((UsesFloat, [Decl], Maybe CheckedMainFunctionDef), HsCompileState)
forall (m :: * -&gt; *) a.
HsCompileT m a -&gt; HsModuleEnv -&gt; m (a, HsCompileState)
</span><a href="Agda.Compiler.MAlonzo.Misc.html#runHsCompileT"><span class="hs-operator hs-var">`runHsCompileT`</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv -&gt; HsModuleEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModHsModuleEnv"><span class="hs-identifier hs-var hs-var">ghcModHsModuleEnv</span></a></span><span> </span><span class="annot"><span class="annottext">GHCModuleEnv
</span><a href="#local-6989586621680807598"><span class="hs-identifier hs-var">menv</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="annottext">GHCDefinition -&gt; TCM GHCDefinition
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(GHCDefinition -&gt; TCM GHCDefinition)
-&gt; GHCDefinition -&gt; TCM GHCDefinition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
-&gt; [Decl]
-&gt; Definition
-&gt; Maybe MainFunctionDef
-&gt; Set ModuleName
-&gt; GHCDefinition
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCDefinition"><span class="hs-identifier hs-var">GHCDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807595"><span class="hs-identifier hs-var">usesFloat</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807594"><span class="hs-identifier hs-var">decls</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807596"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CheckedMainFunctionDef -&gt; MainFunctionDef
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#checkedMainDef"><span class="hs-identifier hs-var hs-var">checkedMainDef</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckedMainFunctionDef -&gt; MainFunctionDef)
-&gt; Maybe CheckedMainFunctionDef -&gt; Maybe MainFunctionDef
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621680807593"><span class="hs-identifier hs-var">mainFuncDef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807591"><span class="hs-identifier hs-var">imps</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | We do not erase types that have a 'HsData' pragma.</span><span>
</span><span id="line-294"></span><span class="hs-comment">--   This is to ensure a stable interface to third-party code.</span><span>
</span><span id="line-295"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-type">ghcMayEraseType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-296"></span><span id="ghcMayEraseType"><span class="annot"><span class="annottext">ghcMayEraseType :: QName -&gt; TCM Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcMayEraseType"><span class="hs-identifier hs-var hs-var">ghcMayEraseType</span></a></span></span><span> </span><span id="local-6989586621680807587"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807587"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807587"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">TCM (Maybe HaskellPragma)
-&gt; (Maybe HaskellPragma -&gt; Bool) -&gt; TCM Bool
forall (m :: * -&gt; *) a b. Functor m =&gt; m a -&gt; (a -&gt; b) -&gt; m b
</span><a href="Agda.Utils.Functor.html#%3C%26%3E"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">-- Andreas, 2019-05-09, issue #3732.</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-comment">-- We restrict this to 'HsData' since types like @Size@, @Level@</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-comment">-- should be erased although they have a 'HsType' binding to the</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-comment">-- Haskell unit type.</span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- Compilation ------------------------------------------------------------</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#imports"><span class="hs-identifier hs-type">imports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#BuiltinThings"><span class="hs-identifier hs-type">BuiltinThings</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimFun"><span class="hs-identifier hs-type">PrimFun</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span id="imports"><span class="annot"><span class="annottext">imports :: BuiltinThings PrimFun
-&gt; Set ModuleName -&gt; [Definition] -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#imports"><span class="hs-identifier hs-var hs-var">imports</span></a></span></span><span> </span><span id="local-6989586621680807583"><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621680807583"><span class="hs-identifier hs-var">builtinThings</span></a></span></span><span> </span><span id="local-6989586621680807582"><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807582"><span class="hs-identifier hs-var">usedModules</span></a></span></span><span> </span><span id="local-6989586621680807581"><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680807581"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621680807580"><span class="hs-identifier hs-var">hsImps</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDecl] -&gt; [ImportDecl] -&gt; [ImportDecl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621680807579"><span class="hs-identifier hs-var">imps</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><a href="#local-6989586621680807580"><span class="hs-identifier hs-type">hsImps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621680807580"><span class="annot"><span class="annottext">hsImps :: [ImportDecl]
</span><a href="#local-6989586621680807580"><span class="hs-identifier hs-var hs-var">hsImps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621680807578"><span class="hs-identifier hs-var">unqualRTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="#local-6989586621680807577"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><a href="#local-6989586621680807578"><span class="hs-identifier hs-type">unqualRTE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621680807578"><span class="annot"><span class="annottext">unqualRTE :: ImportDecl
</span><a href="#local-6989586621680807578"><span class="hs-identifier hs-var hs-var">unqualRTE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-var">HS.ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Bool, [ImportSpec]) -&gt; ImportDecl)
-&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec]))
-&gt; (Bool, [ImportSpec]) -&gt; Maybe (Bool, [ImportSpec])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-313"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ImportSpec
</span><a href="Agda.Utils.Haskell.Syntax.html#IVar"><span class="hs-identifier hs-var">HS.IVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; ImportSpec) -&gt; Name -&gt; ImportSpec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807572"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-314"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680807572"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807572"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerceName"><span class="hs-identifier hs-var">mazCoerceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyTypeName"><span class="hs-identifier hs-var">mazAnyTypeName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-315"></span><span>                             </span><span class="annot"><span class="annottext">(TPrim -&gt; String) -&gt; [TPrim] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span> </span><span class="annot"><span class="annottext">[TPrim]
</span><a href="#local-6989586621680807567"><span class="hs-identifier hs-var">rtePrims</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621680807567"><span class="annot"><span class="annottext">rtePrims :: [TPrim]
</span><a href="#local-6989586621680807567"><span class="hs-identifier hs-var hs-var">rtePrims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PAdd"><span class="hs-identifier hs-var">T.PAdd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PSub"><span class="hs-identifier hs-var">T.PSub</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PMul"><span class="hs-identifier hs-var">T.PMul</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PQuot"><span class="hs-identifier hs-var">T.PQuot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PRem"><span class="hs-identifier hs-var">T.PRem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PGeq"><span class="hs-identifier hs-var">T.PGeq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PLt"><span class="hs-identifier hs-var">T.PLt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEqI"><span class="hs-identifier hs-var">T.PEqI</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>              </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PAdd64"><span class="hs-identifier hs-var">T.PAdd64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PSub64"><span class="hs-identifier hs-var">T.PSub64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PMul64"><span class="hs-identifier hs-var">T.PMul64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PQuot64"><span class="hs-identifier hs-var">T.PQuot64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PRem64"><span class="hs-identifier hs-var">T.PRem64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PLt64"><span class="hs-identifier hs-var">T.PLt64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEq64"><span class="hs-identifier hs-var">T.PEq64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-319"></span><span>              </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PITo64"><span class="hs-identifier hs-var">T.PITo64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#P64ToI"><span class="hs-identifier hs-var">T.P64ToI</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Excludes T.PEqF, which is defined in MAlonzo.RTE.Float</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="#local-6989586621680807579"><span class="hs-identifier hs-type">imps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621680807579"><span class="annot"><span class="annottext">imps :: [ImportDecl]
</span><a href="#local-6989586621680807579"><span class="hs-identifier hs-var hs-var">imps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ImportDecl) -&gt; [ModuleName] -&gt; [ImportDecl]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ImportDecl
</span><a href="#local-6989586621680807577"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; [ImportDecl]) -&gt; [ModuleName] -&gt; [ImportDecl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [ModuleName]
</span><a href="#local-6989586621680807549"><span class="hs-identifier hs-var">uniq</span></a></span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; [ModuleName]) -&gt; [ModuleName] -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun -&gt; [Definition] -&gt; [ModuleName]
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#importsForPrim"><span class="hs-identifier hs-var">importsForPrim</span></a></span><span> </span><span class="annot"><span class="annottext">BuiltinThings PrimFun
</span><a href="#local-6989586621680807583"><span class="hs-identifier hs-var">builtinThings</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680807581"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [ModuleName] -&gt; [ModuleName]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; ModuleName) -&gt; [ModuleName] -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazMod"><span class="hs-identifier hs-var">mazMod</span></a></span><span> </span><span class="annot"><span class="annottext">[ModuleName]
</span><a href="#local-6989586621680807546"><span class="hs-identifier hs-var">mnames</span></a></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="#local-6989586621680807577"><span class="hs-identifier hs-type">decl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621680807577"><span class="annot"><span class="annottext">decl :: ModuleName -&gt; ImportDecl
</span><a href="#local-6989586621680807577"><span class="hs-identifier hs-var hs-var">decl</span></a></span></span><span> </span><span id="local-6989586621680807545"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807545"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-var">HS.ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680807545"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, [ImportSpec])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="#local-6989586621680807546"><span class="hs-identifier hs-type">mnames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621680807546"><span class="annot"><span class="annottext">mnames :: [ModuleName]
</span><a href="#local-6989586621680807546"><span class="hs-identifier hs-var hs-var">mnames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set ModuleName -&gt; [ModuleName]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.elems</span></span><span> </span><span class="annot"><span class="annottext">Set ModuleName
</span><a href="#local-6989586621680807582"><span class="hs-identifier hs-var">usedModules</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><a href="#local-6989586621680807549"><span class="hs-identifier hs-type">uniq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621680807549"><span class="annot"><span class="annottext">uniq :: [ModuleName] -&gt; [ModuleName]
</span><a href="#local-6989586621680807549"><span class="hs-identifier hs-var hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; ModuleName) -&gt; [[ModuleName]] -&gt; [ModuleName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; ModuleName
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([[ModuleName]] -&gt; [ModuleName])
-&gt; ([ModuleName] -&gt; [[ModuleName]]) -&gt; [ModuleName] -&gt; [ModuleName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [[ModuleName]]
forall a. Eq a =&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">List.group</span></span><span> </span><span class="annot"><span class="annottext">([ModuleName] -&gt; [[ModuleName]])
-&gt; ([ModuleName] -&gt; [ModuleName]) -&gt; [ModuleName] -&gt; [[ModuleName]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ModuleName] -&gt; [ModuleName]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.sort</span></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- Should we import MAlonzo.RTE.Float</span><span>
</span><span id="line-334"></span><span class="hs-keyword">newtype</span><span> </span><span id="UsesFloat"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UsesFloat"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680807536"><span id="local-6989586621680807538"><span class="annot"><span class="annottext">UsesFloat -&gt; UsesFloat -&gt; Bool
(UsesFloat -&gt; UsesFloat -&gt; Bool)
-&gt; (UsesFloat -&gt; UsesFloat -&gt; Bool) -&gt; Eq UsesFloat
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: UsesFloat -&gt; UsesFloat -&gt; Bool
$c/= :: UsesFloat -&gt; UsesFloat -&gt; Bool
== :: UsesFloat -&gt; UsesFloat -&gt; Bool
$c== :: UsesFloat -&gt; UsesFloat -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807529"><span id="local-6989586621680807531"><span id="local-6989586621680807533"><span class="annot"><span class="annottext">VerboseLevel -&gt; UsesFloat -&gt; String -&gt; String
[UsesFloat] -&gt; String -&gt; String
UsesFloat -&gt; String
(VerboseLevel -&gt; UsesFloat -&gt; String -&gt; String)
-&gt; (UsesFloat -&gt; String)
-&gt; ([UsesFloat] -&gt; String -&gt; String)
-&gt; Show UsesFloat
forall a.
(VerboseLevel -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [UsesFloat] -&gt; String -&gt; String
$cshowList :: [UsesFloat] -&gt; String -&gt; String
show :: UsesFloat -&gt; String
$cshow :: UsesFloat -&gt; String
showsPrec :: VerboseLevel -&gt; UsesFloat -&gt; String -&gt; String
$cshowsPrec :: VerboseLevel -&gt; UsesFloat -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-type">YesFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-337"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bYesFloat"><span id="%24mYesFloat"><span id="YesFloat"><span class="annot"><span class="annottext">$bYesFloat :: UsesFloat
$mYesFloat :: forall r. UsesFloat -&gt; (Void# -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#%24bYesFloat"><span class="hs-identifier hs-var hs-var hs-var">YesFloat</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NoFloat"><span class="hs-identifier hs-type">NoFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span>
</span><span id="line-340"></span><span class="hs-keyword">pattern</span><span> </span><span id="%24bNoFloat"><span id="%24mNoFloat"><span id="NoFloat"><span class="annot"><span class="annottext">$bNoFloat :: UsesFloat
$mNoFloat :: forall r. UsesFloat -&gt; (Void# -&gt; r) -&gt; (Void# -&gt; r) -&gt; r
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#%24bNoFloat"><span class="hs-identifier hs-var hs-var hs-var">NoFloat</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680807517"><span id="local-6989586621680807519"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621680807515"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807515"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680807514"><span class="annot"><span class="annottext">&lt;&gt; :: UsesFloat -&gt; UsesFloat -&gt; UsesFloat
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621680807513"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807513"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-var">UsesFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807515"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807513"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680807507"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621680807505"><span class="annot"><span class="annottext">mempty :: UsesFloat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#NoFloat"><span class="hs-identifier hs-var">NoFloat</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621680807504"><span class="annot"><span class="annottext">mappend :: UsesFloat -&gt; UsesFloat -&gt; UsesFloat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; UsesFloat -&gt; UsesFloat
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-type">mazRTEFloatImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-type">HS.ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-350"></span><span id="mazRTEFloatImport"><span class="annot"><span class="annottext">mazRTEFloatImport :: UsesFloat -&gt; [ImportDecl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mazRTEFloatImport"><span class="hs-identifier hs-var hs-var">mazRTEFloatImport</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span id="local-6989586621680807503"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807503"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Bool -&gt; Maybe (Bool, [ImportSpec]) -&gt; ImportDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ImportDecl"><span class="hs-identifier hs-var">HS.ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-var">mazRTEFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Bool, [ImportSpec])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807503"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- Main compiling clauses</span><span>
</span><span id="line-354"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-type">definition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Definition"><span class="hs-identifier hs-type">Definition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Primitives.html#CheckedMainFunctionDef"><span class="hs-identifier hs-type">CheckedMainFunctionDef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- ignore irrelevant definitions</span><span>
</span><span id="line-358"></span><span class="hs-comment">{- Andreas, 2012-10-02: Invariant no longer holds
definition kit (Defn NonStrict _ _  _ _ _ _ _ _) = __IMPOSSIBLE__
-}</span><span>
</span><span id="line-361"></span><span id="definition"><span class="annot"><span class="annottext">definition :: Definition
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var hs-var">definition</span></a></span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defArgInfo :: Definition -&gt; ArgInfo
</span><a href="Agda.TypeChecking.Monad.Base.html#defArgInfo"><span class="hs-identifier hs-var">defArgInfo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807499"><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621680807499"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defName :: Definition -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#defName"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807497"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807497"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArgInfo -&gt; Bool
forall a. LensModality a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Common.html#usableModality"><span class="hs-identifier hs-var">usableModality</span></a></span><span> </span><span class="annot"><span class="annottext">ArgInfo
</span><a href="#local-6989586621680807499"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; VerboseLevel
-&gt; TCM Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; VerboseLevel -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Not compiling&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807497"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="annottext">(UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#definition"><span class="hs-identifier hs-var">definition</span></a></span><span> </span><span id="local-6989586621680807491"><span class="annot"><span class="annottext">def :: Definition
</span><a href="#local-6989586621680807491"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Defn"><span class="hs-identifier hs-type">Defn</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">defName :: Definition -&gt; QName
</span><a href="Agda.TypeChecking.Monad.Base.html#defName"><span class="hs-identifier hs-var">defName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807490"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defType :: Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var">defType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807488"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807488"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">theDef :: Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var">theDef</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807486"><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621680807486"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; VerboseLevel
-&gt; TCM Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; VerboseLevel -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#vcat"><span class="hs-identifier hs-var">vcat</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Compiling&quot;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; m Doc -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#%3C%2B%3E"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TCM Doc -&gt; TCM Doc -&gt; TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TCM Doc -&gt; TCM Doc
forall (m :: * -&gt; *). Functor m =&gt; VerboseLevel -&gt; m Doc -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#nest"><span class="hs-identifier hs-var">nest</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; TCM Doc) -&gt; TCM Doc -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; TCM Doc
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defn -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621680807486"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621680807482"><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM (Maybe HaskellPragma)
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma)
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM (Maybe HaskellPragma)
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma))
-&gt; TCM (Maybe HaskellPragma)
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (Maybe HaskellPragma)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621680807480"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807480"><span class="hs-identifier hs-var">mbool</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinBool"><span class="hs-identifier hs-var">builtinBool</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621680807478"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807478"><span class="hs-identifier hs-var">mlist</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinList"><span class="hs-identifier hs-var">builtinList</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621680807476"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807476"><span class="hs-identifier hs-var">mmaybe</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinMaybe"><span class="hs-identifier hs-var">builtinMaybe</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621680807474"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807474"><span class="hs-identifier hs-var">minf</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinInf"><span class="hs-identifier hs-var">builtinInf</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621680807472"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807472"><span class="hs-identifier hs-var">mflat</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinFlat"><span class="hs-identifier hs-var">builtinFlat</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621680807470"><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621680807470"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; HsCompileM (Maybe CheckedMainFunctionDef)
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#checkTypeOfMain"><span class="hs-identifier hs-var">checkTypeOfMain</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807491"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807468"><span class="annot"><span class="annottext">mainDecl :: [Decl]
</span><a href="#local-6989586621680807468"><span class="hs-identifier hs-var hs-var">mainDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Decl -&gt; [Decl]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Decl -&gt; [Decl]) -&gt; Maybe Decl -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CheckedMainFunctionDef -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#checkedMainDecl"><span class="hs-identifier hs-var hs-var">checkedMainDecl</span></a></span><span> </span><span class="annot"><span class="annottext">(CheckedMainFunctionDef -&gt; Decl)
-&gt; Maybe CheckedMainFunctionDef -&gt; Maybe Decl
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621680807470"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807466"><span class="annot"><span class="annottext">retDecls :: b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var hs-var">retDecls</span></a></span></span><span> </span><span id="local-6989586621680807465"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680807465"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; m (a, b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680807465"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UsesFloat
 -&gt; [Decl] -&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef))
-&gt; (UsesFloat, [Decl])
-&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Maybe CheckedMainFunctionDef
</span><a href="#local-6989586621680807470"><span class="hs-identifier hs-var">typeCheckedMainDef</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((UsesFloat, [Decl])
 -&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef))
-&gt; ((UsesFloat, [Decl]) -&gt; (UsesFloat, [Decl]))
-&gt; (UsesFloat, [Decl])
-&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; [Decl]) -&gt; (UsesFloat, [Decl]) -&gt; (UsesFloat, [Decl])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807468"><span class="hs-identifier hs-var">mainDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; [Decl]) -&gt; ([Decl] -&gt; [Decl]) -&gt; [Decl] -&gt; [Decl]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Decl] -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var">infodecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((UsesFloat, [Decl])
 -&gt; (UsesFloat, [Decl], Maybe CheckedMainFunctionDef))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; HsCompileM (UsesFloat, [Decl], Maybe CheckedMainFunctionDef)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Defn
</span><a href="#local-6989586621680807486"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsDefn"><span class="hs-identifier hs-type">HsDefn</span></a></span><span> </span><span id="local-6989586621680807461"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807461"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680807460"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807460"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807461"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-383"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807472"><span class="hs-identifier hs-var">mflat</span></a></span><span>
</span><span id="line-384"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
String -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#genericError"><span class="hs-identifier hs-var">genericError</span></a></span><span>
</span><span id="line-385"></span><span>                </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;COMPILE GHC\&quot; pragmas are not allowed for the FLAT builtin.&quot;</span></span><span>
</span><span id="line-386"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>            </span><span class="hs-comment">-- Make sure we have imports for all names mentioned in the type.</span><span>
</span><span id="line-388"></span><span>            </span><span id="local-6989586621680807458"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807458"><span class="hs-identifier hs-var">hsty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName)
-&gt; Set QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName
-&gt; Name -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xqual"><span class="hs-operator hs-var">`xqual`</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Set QName
forall a m. (NamesIn a, Collection QName m) =&gt; a -&gt; m
</span><a href="Agda.Syntax.Internal.Names.html#namesIn"><span class="hs-identifier hs-var">namesIn</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807488"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span>          </span><span class="hs-comment">-- Check that the function isn't INLINE (since that will make this</span><span>
</span><span id="line-392"></span><span>          </span><span class="hs-comment">-- definition pointless).</span><span>
</span><span id="line-393"></span><span>            </span><span id="local-6989586621680807454"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807454"><span class="hs-identifier hs-var">inline</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Defn -&gt; Lens' Bool Defn -&gt; Bool
forall o i. o -&gt; Lens' i o -&gt; i
</span><a href="Agda.Utils.Lens.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' Bool Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Defn -&gt; Bool) -&gt; (Definition -&gt; Defn) -&gt; Definition -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; Bool)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Definition
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-394"></span><span>            </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807454"><span class="hs-identifier hs-var">inline</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; Warning -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#UselessInline"><span class="hs-identifier hs-var">UselessInline</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span>            </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621680807447"><span class="hs-identifier hs-var">fbWithType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807458"><span class="hs-identifier hs-var">hsty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-var">fakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807460"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-comment">-- Compiling Bool</span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807480"><span class="hs-identifier hs-var">mbool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT HsModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primTrue"><span class="hs-identifier hs-var">primTrue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primFalse"><span class="hs-identifier hs-var">primFalse</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing TRUE/FALSE</span><span>
</span><span id="line-401"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807441"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621680807441"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807439"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807439"><span class="hs-identifier hs-var">true</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinTrue"><span class="hs-identifier hs-var">builtinTrue</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807437"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807437"><span class="hs-identifier hs-var">false</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinFalse"><span class="hs-identifier hs-var">builtinFalse</span></a></span><span>
</span><span id="line-404"></span><span>        </span><span id="local-6989586621680807435"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807435"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807437"><span class="hs-identifier hs-var">false</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807439"><span class="hs-identifier hs-var">true</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-405"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; String -&gt; VerboseLevel -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bool&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-406"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807441"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-407"></span><span>                   </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807435"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>      </span><span class="hs-comment">-- Compiling List</span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807425"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807425"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807478"><span class="hs-identifier hs-var">mlist</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT HsModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primNil"><span class="hs-identifier hs-var">primNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primCons"><span class="hs-identifier hs-var">primCons</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing NIL/CONS</span><span>
</span><span id="line-412"></span><span>        </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; (HaskellPragma
    -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. Maybe a -&gt; b -&gt; (a -&gt; b) -&gt; b
</span><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-var">caseMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((HaskellPragma
  -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; (HaskellPragma
    -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807421"><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621680807421"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HaskellPragma
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621680807421"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; (Doc -&gt; Warning)
-&gt; Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericWarning"><span class="hs-identifier hs-var">GenericWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span>          </span><span class="annot"><span class="annottext">[ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc)
-&gt; [ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ignoring GHC pragma for builtin lists; they always compile to Haskell lists.&quot;</span></span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807417"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621680807417"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-415"></span><span>            </span><span id="local-6989586621680807416"><span class="annot"><span class="annottext">t :: Name
</span><a href="#local-6989586621680807416"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;T&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-416"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807415"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807415"><span class="hs-identifier hs-var">nil</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinNil"><span class="hs-identifier hs-var">builtinNil</span></a></span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807413"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807413"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinCons"><span class="hs-identifier hs-var">builtinCons</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807411"><span class="annot"><span class="annottext">vars :: (Name -&gt; b) -&gt; VerboseLevel -&gt; [b]
</span><a href="#local-6989586621680807411"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621680807410"><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621680807410"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680807409"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807409"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; b) -&gt; [VerboseLevel] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621680807410"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; b) -&gt; (VerboseLevel -&gt; Name) -&gt; VerboseLevel -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807409"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-419"></span><span>        </span><span id="local-6989586621680807407"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807407"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807415"><span class="hs-identifier hs-var">nil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807413"><span class="hs-identifier hs-var">cons</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807416"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; TyVarBind) -&gt; VerboseLevel -&gt; [TyVarBind]
forall b. (Name -&gt; b) -&gt; VerboseLevel -&gt; [b]
</span><a href="#local-6989586621680807411"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807425"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[]&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807417"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; VerboseLevel -&gt; [Pat]
forall b. (Name -&gt; b) -&gt; VerboseLevel -&gt; [b]
</span><a href="#local-6989586621680807411"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807425"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-422"></span><span>                   </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807407"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-comment">-- Compiling Maybe</span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807402"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807402"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807476"><span class="hs-identifier hs-var">mmaybe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ReaderT HsModuleEnv (StateT HsCompileState TCM) Term]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primNothing"><span class="hs-identifier hs-var">primNothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primJust"><span class="hs-identifier hs-var">primJust</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Just to get the proper error for missing NOTHING/JUST</span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; (HaskellPragma
    -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. Maybe a -&gt; b -&gt; (a -&gt; b) -&gt; b
</span><a href="Agda.Utils.Maybe.html#caseMaybe"><span class="hs-identifier hs-var">caseMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((HaskellPragma
  -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; (HaskellPragma
    -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807399"><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621680807399"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HaskellPragma
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621680807399"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Warning -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
(HasCallStack, MonadWarning m) =&gt;
Warning -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#warning"><span class="hs-identifier hs-var">warning</span></a></span><span> </span><span class="annot"><span class="annottext">(Warning -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; (Doc -&gt; Warning)
-&gt; Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Warning
</span><a href="Agda.TypeChecking.Monad.Base.html#GenericWarning"><span class="hs-identifier hs-var">GenericWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>          </span><span class="annot"><span class="annottext">[ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="annot"><span class="annottext">([ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc)
-&gt; [ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Ignoring GHC pragma for builtin maybe; they always compile to Haskell lists.&quot;</span></span><span>
</span><span id="line-429"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807398"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621680807398"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-430"></span><span>            </span><span id="local-6989586621680807397"><span class="annot"><span class="annottext">t :: Name
</span><a href="#local-6989586621680807397"><span class="hs-identifier hs-var hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;T&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807396"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807396"><span class="hs-identifier hs-var">nothing</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinNothing"><span class="hs-identifier hs-var">builtinNothing</span></a></span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807394"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807394"><span class="hs-identifier hs-var">just</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinJust"><span class="hs-identifier hs-var">builtinJust</span></a></span><span>
</span><span id="line-433"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807392"><span class="annot"><span class="annottext">vars :: (Name -&gt; b) -&gt; VerboseLevel -&gt; [b]
</span><a href="#local-6989586621680807392"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621680807391"><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621680807391"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680807390"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807390"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; b) -&gt; [VerboseLevel] -&gt; [b]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; b
</span><a href="#local-6989586621680807391"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; b) -&gt; (VerboseLevel -&gt; Name) -&gt; VerboseLevel -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807390"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>        </span><span id="local-6989586621680807389"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807389"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807396"><span class="hs-identifier hs-var">nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807394"><span class="hs-identifier hs-var">just</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807397"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; TyVarBind) -&gt; VerboseLevel -&gt; [TyVarBind]
forall b. (Name -&gt; b) -&gt; VerboseLevel -&gt; [b]
</span><a href="#local-6989586621680807392"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807402"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Maybe&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807398"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; VerboseLevel -&gt; [Pat]
forall b. (Name -&gt; b) -&gt; VerboseLevel -&gt; [b]
</span><a href="#local-6989586621680807392"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807402"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-437"></span><span>                   </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807389"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span>      </span><span class="hs-comment">-- Compiling Inf</span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807474"><span class="hs-identifier hs-var">minf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="annottext">Term
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Term
forall (m :: * -&gt; *).
(HasBuiltins m, MonadError TCErr m, MonadTCEnv m, ReadTCState m) =&gt;
m Term
</span><a href="Agda.TypeChecking.Monad.Builtin.html#primSharp"><span class="hs-identifier hs-var">primSharp</span></a></span><span> </span><span class="hs-comment">-- To get a proper error for missing SHARP.</span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807387"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807387"><span class="hs-identifier hs-var">sharp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinSharp"><span class="hs-identifier hs-var">builtinSharp</span></a></span><span>
</span><span id="line-443"></span><span>        </span><span id="local-6989586621680807385"><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621680807385"><span class="hs-identifier hs-var">sharpC</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807387"><span class="hs-identifier hs-var">sharp</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807384"><span class="annot"><span class="annottext">d :: Name
</span><a href="#local-6989586621680807384"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-445"></span><span>            </span><span id="local-6989586621680807383"><span class="annot"><span class="annottext">err :: String
</span><a href="#local-6989586621680807383"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No term-level implementation of the INFINITY builtin.&quot;</span></span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; String -&gt; VerboseLevel -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MAlonzo.RTE.Infinity&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">2</span></span><span>
</span><span id="line-447"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807384"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-448"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeExp"><span class="hs-identifier hs-var">HS.FakeExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807383"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>                       </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-450"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621680807385"><span class="hs-identifier hs-var">sharpC</span></a></span><span>
</span><span id="line-451"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#DataOrRecSig"><span class="hs-identifier hs-type">DataOrRecSig</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Axiom"><span class="hs-identifier hs-type">Axiom</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-456"></span><span>        </span><span id="local-6989586621680807377"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807377"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM VerboseLevel
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) VerboseLevel
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM VerboseLevel
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) VerboseLevel)
-&gt; TCM VerboseLevel
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) VerboseLevel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; TCM VerboseLevel
</span><a href="Agda.TypeChecking.Telescope.html#typeArity"><span class="hs-identifier hs-var">typeArity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807488"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-457"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; String -&gt; VerboseLevel -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807375"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807377"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsType"><span class="hs-identifier hs-type">HsType</span></a></span><span> </span><span id="local-6989586621680807373"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807373"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680807375"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807375"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-458"></span><span>                   </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621680807372"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807371"><span class="hs-identifier hs-var">axiomErr</span></a></span><span>
</span><span id="line-459"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Primitive"><span class="hs-identifier hs-type">Primitive</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">primName :: Defn -&gt; String
</span><a href="Agda.TypeChecking.Monad.Base.html#primName"><span class="hs-identifier hs-var">primName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807368"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807368"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; (UsesFloat, [Decl]))
-&gt; (Exp -&gt; [Decl]) -&gt; Exp -&gt; (UsesFloat, [Decl])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621680807372"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; (UsesFloat, [Decl]))
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Exp -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Exp -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp)
-&gt; (String -&gt; TCM Exp)
-&gt; String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; TCM Exp
forall (m :: * -&gt; *). MonadTCError m =&gt; String -&gt; m Exp
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#primBody"><span class="hs-identifier hs-var">primBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807368"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#PrimitiveSort"><span class="hs-identifier hs-type">PrimitiveSort</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">primName :: Defn -&gt; String
</span><a href="Agda.TypeChecking.Monad.Base.html#primName"><span class="hs-identifier hs-var">primName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807365"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807365"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621680807363"><span class="hs-identifier hs-var">function</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621680807362"><span class="hs-identifier hs-var">functionViaTreeless</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPathCons :: Defn -&gt; [QName]
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPathCons"><span class="hs-identifier hs-var">dataPathCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>        </span><span id="local-6989586621680807360"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807360"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Doc -&gt; String
</span><span class="hs-identifier hs-var">render</span></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; String)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-467"></span><span>        </span><span class="annot"><span class="annottext">TypeError
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
TypeError -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#typeError"><span class="hs-identifier hs-var">typeError</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeError
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; TypeError
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; TypeError
</span><a href="Agda.TypeChecking.Monad.Base.html#NotImplemented"><span class="hs-identifier hs-var">NotImplemented</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TypeError) -&gt; String -&gt; TypeError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-468"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Higher inductive types (&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807360"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807357"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807357"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataIxs :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#dataIxs"><span class="hs-identifier hs-var">dataIxs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807355"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807355"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#dataClause"><span class="hs-identifier hs-var">dataClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807353"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621680807353"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-471"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680807352"><span class="annot"><span class="annottext">hsdata :: HaskellPragma
</span><a href="#local-6989586621680807352"><span class="hs-identifier hs-var">hsdata</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span> </span><span id="local-6989586621680807351"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807351"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680807350"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807350"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680807349"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807349"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807351"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-472"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; VerboseLevel
-&gt; TCM Doc
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (m :: * -&gt; *).
MonadDebug m =&gt;
String -&gt; VerboseLevel -&gt; TCM Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Monad.Debug.html#reportSDoc"><span class="hs-identifier hs-var">reportSDoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile.ghc.definition&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">40</span></span><span> </span><span class="annot"><span class="annottext">(TCM Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM Doc -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[TCM Doc] -&gt; TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#hsep"><span class="hs-identifier hs-var">hsep</span></a></span><span> </span><span class="annot"><span class="annottext">([TCM Doc] -&gt; TCM Doc) -&gt; [TCM Doc] -&gt; TCM Doc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-473"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TCM Doc
</span><span class="hs-string">&quot;Compiling data type with COMPILE pragma ...&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HaskellPragma -&gt; TCM Doc
forall (m :: * -&gt; *) a. (Applicative m, Pretty a) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">HaskellPragma
</span><a href="#local-6989586621680807352"><span class="hs-identifier hs-var">hsdata</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-474"></span><span>        </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-475"></span><span>        </span><span id="local-6989586621680807345"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807345"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [QName]
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [QName]
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [QName])
-&gt; TCM [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM [QName]
</span><a href="Agda.TypeChecking.Datatypes.html#getNotErasedConstructors"><span class="hs-identifier hs-var">getNotErasedConstructors</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-476"></span><span>        </span><span id="local-6989586621680807343"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807343"><span class="hs-identifier hs-var">ccscov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; VerboseLevel
-&gt; [QName]
-&gt; String
-&gt; [String]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var">constructorCoverageCode</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807357"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807355"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807345"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807350"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807349"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-477"></span><span>        </span><span id="local-6989586621680807340"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807340"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807345"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-478"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807339"><span class="annot"><span class="annottext">result :: [Decl]
</span><a href="#local-6989586621680807339"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Decl]] -&gt; [Decl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Decl]] -&gt; [Decl]) -&gt; [[Decl]] -&gt; [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-479"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction -&gt; VerboseLevel -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807357"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807355"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Clause -&gt; Maybe Clause
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Clause
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QName -&gt; String -&gt; VerboseLevel -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807350"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807357"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-481"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807340"><span class="hs-identifier hs-var">cds</span></a></span><span>
</span><span id="line-482"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807343"><span class="hs-identifier hs-var">ccscov</span></a></span><span>
</span><span id="line-483"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-484"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807339"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-485"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataPars :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#dataPars"><span class="hs-identifier hs-var">dataPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807335"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807335"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataIxs :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#dataIxs"><span class="hs-identifier hs-var">dataIxs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807334"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807334"><span class="hs-identifier hs-var">ni</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#dataClause"><span class="hs-identifier hs-var">dataClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807333"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621680807333"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>        </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-487"></span><span>        </span><span id="local-6989586621680807332"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807332"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [QName]
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [QName]
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [QName])
-&gt; TCM [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [QName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM [QName]
</span><a href="Agda.TypeChecking.Datatypes.html#getNotErasedConstructors"><span class="hs-identifier hs-var">getNotErasedConstructors</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span id="local-6989586621680807331"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621680807331"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl)
-&gt; [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [ConDecl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(QName
 -&gt; Induction
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl)
-&gt; Induction
-&gt; QName
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var">condecl</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807332"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-489"></span><span>        </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction -&gt; VerboseLevel -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807335"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807334"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621680807331"><span class="hs-identifier hs-var">cds</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621680807333"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-490"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-491"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#GeneralizableVar"><span class="hs-identifier hs-type">GeneralizableVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-492"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Record"><span class="hs-identifier hs-type">Record</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">recPars :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#recPars"><span class="hs-identifier hs-var">recPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807325"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807325"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recClause :: Defn -&gt; Maybe Clause
</span><a href="Agda.TypeChecking.Monad.Base.html#recClause"><span class="hs-identifier hs-var">recClause</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807323"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621680807323"><span class="hs-identifier hs-var">cl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">recConHead :: Defn -&gt; ConHead
</span><a href="Agda.TypeChecking.Monad.Base.html#recConHead"><span class="hs-identifier hs-var">recConHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807321"><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621680807321"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">,</span><span>
</span><span id="line-493"></span><span>              </span><span class="annot"><span class="annottext">recInduction :: Defn -&gt; Maybe Induction
</span><a href="Agda.TypeChecking.Monad.Base.html#recInduction"><span class="hs-identifier hs-var">recInduction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807319"><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621680807319"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-494"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Non-recursive record types are treated as being</span><span>
</span><span id="line-495"></span><span>            </span><span class="hs-comment">-- inductive.</span><span>
</span><span id="line-496"></span><span>            </span><span id="local-6989586621680807318"><span class="annot"><span class="annottext">inductionKind :: Induction
</span><a href="#local-6989586621680807318"><span class="hs-identifier hs-var hs-var">inductionKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Induction -&gt; Maybe Induction -&gt; Induction
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Induction
</span><a href="#local-6989586621680807319"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-497"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807482"><span class="hs-identifier hs-var">pragma</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-498"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsData"><span class="hs-identifier hs-type">HsData</span></a></span><span> </span><span id="local-6989586621680807317"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807317"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680807316"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807316"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680807315"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807315"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807317"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807314"><span class="annot"><span class="annottext">cs :: [QName]
</span><a href="#local-6989586621680807314"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621680807321"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-500"></span><span>            </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-501"></span><span>            </span><span id="local-6989586621680807312"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807312"><span class="hs-identifier hs-var">ccscov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; VerboseLevel
-&gt; [QName]
-&gt; String
-&gt; [String]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var">constructorCoverageCode</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807325"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807314"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807316"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807315"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-502"></span><span>            </span><span id="local-6989586621680807311"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807311"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; [QName]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var">compiledcondecl</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807314"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-503"></span><span>            </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-504"></span><span>              </span><span class="annot"><span class="annottext">QName
-&gt; Induction -&gt; VerboseLevel -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621680807318"><span class="hs-identifier hs-var">inductionKind</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807325"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Clause -&gt; Maybe Clause
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Clause
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-505"></span><span>              </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QName -&gt; String -&gt; VerboseLevel -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var">compiledTypeSynonym</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807316"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807325"><span class="hs-identifier hs-var">np</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807311"><span class="hs-identifier hs-var">cds</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807312"><span class="hs-identifier hs-var">ccscov</span></a></span><span>
</span><span id="line-506"></span><span>          </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>            </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM ()
</span><a href="Agda.Compiler.Treeless.Erase.html#computeErasedConstructorArgs"><span class="hs-identifier hs-var">computeErasedConstructorArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-508"></span><span>            </span><span id="local-6989586621680807310"><span class="annot"><span class="annottext">ConDecl
</span><a href="#local-6989586621680807310"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var">condecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConHead -&gt; QName
</span><a href="Agda.Syntax.Internal.html#conName"><span class="hs-identifier hs-var hs-var">conName</span></a></span><span> </span><span class="annot"><span class="annottext">ConHead
</span><a href="#local-6989586621680807321"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621680807318"><span class="hs-identifier hs-var">inductionKind</span></a></span><span>
</span><span id="line-509"></span><span>            </span><span class="annot"><span class="annottext">[Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b. (Monad m, Monoid a) =&gt; b -&gt; m (a, b)
</span><a href="#local-6989586621680807466"><span class="hs-identifier hs-var">retDecls</span></a></span><span> </span><span class="annot"><span class="annottext">([Decl]
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; [Decl]
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; Induction -&gt; VerboseLevel -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var">tvaldecl</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621680807318"><span class="hs-identifier hs-var">inductionKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; VerboseLevel
</span><a href="Agda.Syntax.Internal.html#arity"><span class="hs-identifier hs-var">I.arity</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807488"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ConDecl
</span><a href="#local-6989586621680807310"><span class="hs-identifier hs-var">cd</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621680807323"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#AbstractDefn"><span class="hs-identifier hs-type">AbstractDefn</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-512"></span><span>  </span><span class="annot"><a href="#local-6989586621680807363"><span class="hs-identifier hs-type">function</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellPragma"><span class="hs-identifier hs-type">HaskellPragma</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>  </span><span id="local-6989586621680807363"><span class="annot"><span class="annottext">function :: Maybe HaskellPragma
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621680807363"><span class="hs-identifier hs-var hs-var">function</span></a></span></span><span> </span><span id="local-6989586621680807307"><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807307"><span class="hs-identifier hs-var">mhe</span></a></span></span><span> </span><span id="local-6989586621680807306"><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621680807306"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680807305"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807305"><span class="hs-identifier hs-var">imp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807304"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807304"><span class="hs-identifier hs-var">defs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621680807306"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807303"><span class="annot"><span class="annottext">ccls :: [Decl]
</span><a href="#local-6989586621680807303"><span class="hs-identifier hs-var hs-var">ccls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl]
</span><a href="#local-6989586621680807302"><span class="hs-identifier hs-var">mkwhere</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807304"><span class="hs-identifier hs-var">defs</span></a></span><span>
</span><span id="line-516"></span><span>    </span><span id="local-6989586621680807301"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807301"><span class="hs-identifier hs-var">mflat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinFlat"><span class="hs-identifier hs-var">builtinFlat</span></a></span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><a href="#local-6989586621680807307"><span class="hs-identifier hs-var">mhe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-518"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HsExport"><span class="hs-identifier hs-type">HsExport</span></a></span><span> </span><span id="local-6989586621680807299"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807299"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680807298"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807298"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Range
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807299"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-519"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807301"><span class="hs-identifier hs-var">mflat</span></a></span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a.
(HasCallStack, MonadTCError m) =&gt;
String -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Base.html#genericError"><span class="hs-identifier hs-var">genericError</span></a></span><span>
</span><span id="line-521"></span><span>              </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;COMPILE GHC as\&quot; pragmas are not allowed for the FLAT builtin.&quot;</span></span><span>
</span><span id="line-522"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-523"></span><span>          </span><span id="local-6989586621680807297"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807297"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range -&gt; HsCompileM Type -&gt; HsCompileM Type
forall (m :: * -&gt; *) x a.
(MonadTrace m, HasRange x) =&gt;
x -&gt; m a -&gt; m a
</span><a href="Agda.TypeChecking.Monad.Trace.html#setCurrentRange"><span class="hs-identifier hs-var">setCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621680807299"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileM Type -&gt; HsCompileM Type)
-&gt; HsCompileM Type -&gt; HsCompileM Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-524"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680807296"><span class="hs-identifier hs-type">tsig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-525"></span><span>              </span><span id="local-6989586621680807296"><span class="annot"><span class="annottext">tsig :: Decl
</span><a href="#local-6989586621680807296"><span class="hs-identifier hs-var hs-var">tsig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807298"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807297"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span>              </span><span class="annot"><a href="#local-6989586621680807294"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-528"></span><span>              </span><span id="local-6989586621680807294"><span class="annot"><span class="annottext">def :: Decl
</span><a href="#local-6989586621680807294"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807298"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; Exp -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-529"></span><span>          </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807305"><span class="hs-identifier hs-var">imp</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621680807296"><span class="hs-identifier hs-var">tsig</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Decl
</span><a href="#local-6989586621680807294"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807303"><span class="hs-identifier hs-var">ccls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>      </span><span class="annot"><span class="annottext">Maybe HaskellPragma
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807305"><span class="hs-identifier hs-var">imp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807303"><span class="hs-identifier hs-var">ccls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span>  </span><span class="annot"><a href="#local-6989586621680807362"><span class="hs-identifier hs-type">functionViaTreeless</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>  </span><span id="local-6989586621680807362"><span class="annot"><span class="annottext">functionViaTreeless :: QName
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
</span><a href="#local-6989586621680807362"><span class="hs-identifier hs-var hs-var">functionViaTreeless</span></a></span></span><span> </span><span id="local-6989586621680807290"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe TTerm)
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
-&gt; (TTerm
    -&gt; ReaderT
         HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a b.
Monad m =&gt;
m (Maybe a) -&gt; m b -&gt; (a -&gt; m b) -&gt; m b
</span><a href="Agda.Utils.Maybe.html#caseMaybeM"><span class="hs-identifier hs-var">caseMaybeM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM (Maybe TTerm)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe TTerm)
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM (Maybe TTerm)
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe TTerm))
-&gt; TCM (Maybe TTerm)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe TTerm)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy -&gt; QName -&gt; TCM (Maybe TTerm)
</span><a href="Agda.Compiler.ToTreeless.html#toTreeless"><span class="hs-identifier hs-var">toTreeless</span></a></span><span> </span><span class="annot"><span class="annottext">EvaluationStrategy
</span><a href="Agda.Syntax.Treeless.html#LazyEvaluation"><span class="hs-identifier hs-var">LazyEvaluation</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((TTerm
  -&gt; ReaderT
       HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
 -&gt; ReaderT
      HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; (TTerm
    -&gt; ReaderT
         HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl]))
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807286"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807286"><span class="hs-identifier hs-var">treeless</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>    </span><span id="local-6989586621680807285"><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807285"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Maybe [ArgUsage] -&gt; [ArgUsage]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [ArgUsage] -&gt; [ArgUsage])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [ArgUsage]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe [ArgUsage])
</span><a href="Agda.TypeChecking.Monad.Signature.html#getCompiledArgUse"><span class="hs-identifier hs-var">getCompiledArgUse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807283"><span class="annot"><span class="annottext">dostrip :: Bool
</span><a href="#local-6989586621680807283"><span class="hs-identifier hs-var hs-var">dostrip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="annot"><span class="annottext">ArgUsage -&gt; [ArgUsage] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807285"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-comment">-- Compute the type approximation</span><span>
</span><span id="line-539"></span><span>    </span><span id="local-6989586621680807280"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807280"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680807279"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807279"><span class="hs-identifier hs-var">argTypes0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807278"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807278"><span class="hs-identifier hs-var">resType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; HsCompileM ([Type], Type)
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#hsTelApproximation"><span class="hs-identifier hs-var">hsTelApproximation</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; HsCompileM ([Type], Type))
-&gt; Type -&gt; HsCompileM ([Type], Type)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807280"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807276"><span class="annot"><span class="annottext">pars :: VerboseLevel
</span><a href="#local-6989586621680807276"><span class="hs-identifier hs-var hs-var">pars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680807280"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-542"></span><span>                 </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funProjection :: Defn -&gt; Maybe Projection
</span><a href="Agda.TypeChecking.Monad.Base.html#funProjection"><span class="hs-identifier hs-var">funProjection</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Projection"><span class="hs-identifier hs-type">Projection</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">projIndex :: Projection -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#projIndex"><span class="hs-identifier hs-var">projIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807272"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807272"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807272"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807272"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span>
</span><span id="line-543"></span><span>                 </span><span class="annot"><span class="annottext">Defn
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-544"></span><span>        </span><span id="local-6989586621680807270"><span class="annot"><span class="annottext">argTypes :: [Type]
</span><a href="#local-6989586621680807270"><span class="hs-identifier hs-var hs-var">argTypes</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [Type] -&gt; [Type]
forall a. VerboseLevel -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807276"><span class="hs-identifier hs-var">pars</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807279"><span class="hs-identifier hs-var">argTypes0</span></a></span><span>
</span><span id="line-545"></span><span>        </span><span id="local-6989586621680807268"><span class="annot"><span class="annottext">argTypesS :: [Type]
</span><a href="#local-6989586621680807268"><span class="hs-identifier hs-var hs-var">argTypesS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; [Type] -&gt; [Type]
forall a. [ArgUsage] -&gt; [a] -&gt; [a]
</span><a href="Agda.Syntax.Treeless.html#filterUsed"><span class="hs-identifier hs-var">filterUsed</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807285"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807270"><span class="hs-identifier hs-var">argTypes</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680807266"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807266"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807265"><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807265"><span class="hs-identifier hs-var">useFloat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807283"><span class="hs-identifier hs-var">dostrip</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var">closedTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ArgUsage] -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Compiler.Treeless.Unused.html#stripUnusedArguments"><span class="hs-identifier hs-var">stripUnusedArguments</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807285"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807286"><span class="hs-identifier hs-var">treeless</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>                                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var">closedTerm</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807286"><span class="hs-identifier hs-var">treeless</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680807262"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807262"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807261"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807261"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; ([Pat], Exp)
</span><a href="#local-6989586621680807260"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807266"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-550"></span><span>        </span><span id="local-6989586621680807260"><span class="annot"><span class="annottext">lamView :: Exp -&gt; ([Pat], Exp)
</span><a href="#local-6989586621680807260"><span class="hs-identifier hs-var hs-var">lamView</span></a></span></span><span> </span><span id="local-6989586621680807259"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807259"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-551"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807259"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-552"></span><span>            </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Lambda"><span class="hs-identifier hs-type">HS.Lambda</span></a></span><span> </span><span id="local-6989586621680807257"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807257"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680807256"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807256"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807257"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807256"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>            </span><span id="local-6989586621680807255"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807255"><span class="hs-identifier hs-var">b</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807255"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span>        </span><span id="local-6989586621680807254"><span class="annot"><span class="annottext">tydecl :: Name -&gt; t Type -&gt; Type -&gt; Decl
</span><a href="#local-6989586621680807254"><span class="hs-identifier hs-var hs-var">tydecl</span></a></span></span><span>  </span><span id="local-6989586621680807253"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807253"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680807252"><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621680807252"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621680807251"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807251"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807253"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; t Type -&gt; Type
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyFun"><span class="hs-identifier hs-var">HS.TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807251"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">t Type
</span><a href="#local-6989586621680807252"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>        </span><span id="local-6989586621680807248"><span class="annot"><span class="annottext">funbind :: Name -&gt; [Pat] -&gt; Exp -&gt; Decl
</span><a href="#local-6989586621680807248"><span class="hs-identifier hs-var hs-var">funbind</span></a></span></span><span> </span><span id="local-6989586621680807247"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807247"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680807246"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807246"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680807245"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807245"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807247"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807246"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807245"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-557"></span><span>        </span><span id="local-6989586621680807244"><span class="annot"><span class="annottext">tyfunbind :: Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621680807244"><span class="hs-identifier hs-var hs-var">tyfunbind</span></a></span></span><span> </span><span id="local-6989586621680807243"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807243"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680807242"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807242"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621680807241"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807241"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680807240"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807240"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680807239"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807239"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807238"><span class="annot"><span class="annottext">ts' :: [Type]
</span><a href="#local-6989586621680807238"><span class="hs-identifier hs-var hs-var">ts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807242"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; Type -&gt; [Type]
forall a. VerboseLevel -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pat] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807240"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807242"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazAnyType"><span class="hs-identifier hs-var">mazAnyType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; Decl
forall (t :: * -&gt; *). Foldable t =&gt; Name -&gt; t Type -&gt; Type -&gt; Decl
</span><a href="#local-6989586621680807254"><span class="hs-identifier hs-var">tydecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807243"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807238"><span class="hs-identifier hs-var">ts'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807241"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Exp -&gt; Decl
</span><a href="#local-6989586621680807248"><span class="hs-identifier hs-var">funbind</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807243"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807240"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807239"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-comment">-- The definition of the non-stripped function</span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680807234"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807234"><span class="hs-identifier hs-var">ps0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; ([Pat], Exp)
</span><a href="#local-6989586621680807260"><span class="hs-identifier hs-var">lamView</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; ([Pat], Exp))
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ([Pat], Exp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-var">closedTerm_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm)
-&gt; TTerm -&gt; [TTerm -&gt; TTerm] -&gt; TTerm
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TErased"><span class="hs-identifier hs-var">T.TErased</span></a></span><span> </span><span class="annot"><span class="annottext">([TTerm -&gt; TTerm] -&gt; TTerm) -&gt; [TTerm -&gt; TTerm] -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; (TTerm -&gt; TTerm) -&gt; [TTerm -&gt; TTerm]
forall a. VerboseLevel -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ArgUsage] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807285"><span class="hs-identifier hs-var">used</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TLam"><span class="hs-identifier hs-var">T.TLam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807230"><span class="annot"><span class="annottext">b0 :: Exp
</span><a href="#local-6989586621680807230"><span class="hs-identifier hs-var hs-var">b0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-var">duname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807226"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-type">HS.PVar</span></a></span><span> </span><span id="local-6989586621680807226"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807226"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUsed"><span class="hs-identifier hs-var">ArgUsed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; [ArgUsage] -&gt; [(Pat, ArgUsage)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807234"><span class="hs-identifier hs-var">ps0</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807285"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><span class="annottext">(UsesFloat, [Decl])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (UsesFloat, [Decl])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UsesFloat
</span><a href="#local-6989586621680807265"><span class="hs-identifier hs-var">useFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-566"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807283"><span class="hs-identifier hs-var">dostrip</span></a></span><span>
</span><span id="line-567"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621680807244"><span class="hs-identifier hs-var">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807270"><span class="hs-identifier hs-var">argTypes</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807278"><span class="hs-identifier hs-var">resType</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807234"><span class="hs-identifier hs-var">ps0</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807230"><span class="hs-identifier hs-var">b0</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-568"></span><span>                   </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621680807244"><span class="hs-identifier hs-var">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#duname"><span class="hs-identifier hs-var">duname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807268"><span class="hs-identifier hs-var">argTypesS</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807278"><span class="hs-identifier hs-var">resType</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807262"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807261"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-569"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Type] -&gt; Type -&gt; [Pat] -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621680807244"><span class="hs-identifier hs-var">tyfunbind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#dname"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807290"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680807270"><span class="hs-identifier hs-var">argTypes</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807278"><span class="hs-identifier hs-var">resType</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807262"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807261"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>  </span><span class="annot"><a href="#local-6989586621680807302"><span class="hs-identifier hs-type">mkwhere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-572"></span><span>  </span><span id="local-6989586621680807302"><span class="annot"><span class="annottext">mkwhere :: [Decl] -&gt; [Decl]
</span><a href="#local-6989586621680807302"><span class="hs-identifier hs-var hs-var">mkwhere</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-type">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680807224"><span class="annot"><span class="annottext">Match
</span><a href="#local-6989586621680807224"><span class="hs-identifier hs-var">m0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-type">HS.Match</span></a></span><span> </span><span id="local-6989586621680807223"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807223"><span class="hs-identifier hs-var">dn</span></a></span></span><span> </span><span id="local-6989586621680807222"><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807222"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680807221"><span class="annot"><span class="annottext">Rhs
</span><a href="#local-6989586621680807221"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680807220"><span class="annot"><span class="annottext">Maybe Binds
</span><a href="#local-6989586621680807220"><span class="hs-identifier hs-var">emptyBinds</span></a></span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680807219"><span class="annot"><span class="annottext">fbs :: [Decl]
</span><a href="#local-6989586621680807219"><span class="hs-identifier hs-var">fbs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decl
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Decl]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-573"></span><span>          </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Match
</span><a href="#local-6989586621680807224"><span class="hs-identifier hs-var">m0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807223"><span class="hs-identifier hs-var">dn</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680807222"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Rhs
</span><a href="#local-6989586621680807221"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="#local-6989586621680807218"><span class="hs-identifier hs-var">bindsAux</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="#local-6989586621680807218"><span class="hs-identifier hs-type">bindsAux</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Binds"><span class="hs-identifier hs-type">HS.Binds</span></a></span><span>
</span><span id="line-576"></span><span>    </span><span id="local-6989586621680807218"><span class="annot"><span class="annottext">bindsAux :: Maybe Binds
</span><a href="#local-6989586621680807218"><span class="hs-identifier hs-var hs-var">bindsAux</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binds -&gt; Maybe Binds
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Binds -&gt; Maybe Binds) -&gt; Binds -&gt; Maybe Binds
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; Binds
</span><a href="Agda.Utils.Haskell.Syntax.html#BDecls"><span class="hs-identifier hs-var">HS.BDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807219"><span class="hs-identifier hs-var">fbs</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>  </span><span class="annot"><a href="#local-6989586621680807302"><span class="hs-identifier hs-var">mkwhere</span></a></span><span> </span><span id="local-6989586621680807216"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807216"><span class="hs-identifier hs-var">fbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807216"><span class="hs-identifier hs-var">fbs</span></a></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span>  </span><span class="annot"><a href="#local-6989586621680807447"><span class="hs-identifier hs-type">fbWithType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Type"><span class="hs-identifier hs-type">HS.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-581"></span><span>  </span><span id="local-6989586621680807447"><span class="annot"><span class="annottext">fbWithType :: Type -&gt; Exp -&gt; [Decl]
</span><a href="#local-6989586621680807447"><span class="hs-identifier hs-var hs-var">fbWithType</span></a></span></span><span> </span><span id="local-6989586621680807215"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807215"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680807214"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807214"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807215"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Decl]
</span><a href="#local-6989586621680807372"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807214"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><a href="#local-6989586621680807372"><span class="hs-identifier hs-type">fb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621680807372"><span class="annot"><span class="annottext">fb :: Exp -&gt; [Decl]
</span><a href="#local-6989586621680807372"><span class="hs-identifier hs-var hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621680807213"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807213"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-586"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807213"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span>  </span><span class="annot"><a href="#local-6989586621680807371"><span class="hs-identifier hs-type">axiomErr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-589"></span><span>  </span><span id="local-6989586621680807371"><span class="annot"><span class="annottext">axiomErr :: Exp
</span><a href="#local-6989586621680807371"><span class="hs-identifier hs-var hs-var">axiomErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmError"><span class="hs-identifier hs-var">rtmError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Exp) -&gt; Text -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;postulate evaluated: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807490"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-type">constructorCoverageCode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellType"><span class="hs-identifier hs-type">HaskellType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-592"></span><span id="constructorCoverageCode"><span class="annot"><span class="annottext">constructorCoverageCode :: QName
-&gt; VerboseLevel
-&gt; [QName]
-&gt; String
-&gt; [String]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#constructorCoverageCode"><span class="hs-identifier hs-var hs-var">constructorCoverageCode</span></a></span></span><span> </span><span id="local-6989586621680807208"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807208"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680807207"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807207"><span class="hs-identifier hs-var">np</span></a></span></span><span> </span><span id="local-6989586621680807206"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807206"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621680807205"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807205"><span class="hs-identifier hs-var">hsTy</span></a></span></span><span> </span><span id="local-6989586621680807204"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807204"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-593"></span><span>  </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ())
-&gt; TCM () -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; [QName] -&gt; [String] -&gt; TCM ()
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#checkConstructorCount"><span class="hs-identifier hs-var">checkConstructorCount</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807208"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807206"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807204"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-594"></span><span>  </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Bool
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><a href="Agda.Utils.Monad.html#ifM"><span class="hs-identifier hs-var">ifM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TCM Bool -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Bool
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Bool -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Bool)
-&gt; TCM Bool -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM Bool
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
QName -&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#noCheckCover"><span class="hs-identifier hs-var">noCheckCover</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807208"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl] -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-595"></span><span>    </span><span id="local-6989586621680807201"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807201"><span class="hs-identifier hs-var">ccs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[Decl]] -&gt; [Decl]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">List.concat</span></span><span> </span><span class="annot"><span class="annottext">([[Decl]] -&gt; [Decl])
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [[Decl]]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(QName
 -&gt; String
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; [QName]
-&gt; [String]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [[Decl]]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; String -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-var">checkConstructorType</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807206"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807204"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-596"></span><span>    </span><span id="local-6989586621680807198"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807198"><span class="hs-identifier hs-var">cov</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM [Decl]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM [Decl]
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; TCM [Decl]
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; String -&gt; VerboseLevel -&gt; [QName] -&gt; [String] -&gt; TCM [Decl]
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; String -&gt; VerboseLevel -&gt; [QName] -&gt; [String] -&gt; m [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-var">checkCover</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807208"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807205"><span class="hs-identifier hs-var">hsTy</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807207"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807206"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807204"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><span class="annottext">[Decl] -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([Decl] -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl])
-&gt; [Decl] -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807201"><span class="hs-identifier hs-var">ccs</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl] -&gt; [Decl] -&gt; [Decl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680807198"><span class="hs-identifier hs-var">cov</span></a></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">-- | Environment for naming of local variables.</span><span>
</span><span id="line-600"></span><span class="hs-comment">--   Invariant: @reverse ccCxt ++ ccNameSupply@</span><span>
</span><span id="line-601"></span><span class="hs-keyword">data</span><span> </span><span id="CCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-var">CCEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CCEnv"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-var">CCEnv</span></a></span></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_ccNameSupply"><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var hs-var">_ccNameSupply</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-type">NameSupply</span></a></span><span>  </span><span class="hs-comment">-- ^ Supply of fresh names</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="_ccContext"><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var hs-var">_ccContext</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span>   </span><span class="hs-comment">-- ^ Names currently in scope</span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-keyword">type</span><span> </span><span id="NameSupply"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-var">NameSupply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-607"></span><span class="hs-keyword">type</span><span> </span><span id="CCContext"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-var">CCContext</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-type">ccNameSupply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#NameSupply"><span class="hs-identifier hs-type">NameSupply</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-610"></span><span id="ccNameSupply"><span class="annot"><span class="annottext">ccNameSupply :: ([Name] -&gt; f [Name]) -&gt; CCEnv -&gt; f CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var hs-var">ccNameSupply</span></a></span></span><span> </span><span id="local-6989586621680807190"><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621680807190"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680807189"><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621680807189"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807188"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807188"><span class="hs-identifier hs-var">ns'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621680807189"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_ccNameSupply :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807188"><span class="hs-identifier hs-var">ns'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; CCEnv) -&gt; f [Name] -&gt; f CCEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621680807190"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var hs-var">_ccNameSupply</span></a></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621680807189"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-type">ccContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Lens.html#Lens%27"><span class="hs-identifier hs-type">Lens'</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-613"></span><span id="ccContext"><span class="annot"><span class="annottext">ccContext :: ([Name] -&gt; f [Name]) -&gt; CCEnv -&gt; f CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var hs-var">ccContext</span></a></span></span><span> </span><span id="local-6989586621680807186"><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621680807186"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680807185"><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621680807185"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807184"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807184"><span class="hs-identifier hs-var">cxt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621680807185"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_ccContext :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807184"><span class="hs-identifier hs-var">cxt</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; CCEnv) -&gt; f [Name] -&gt; f CCEnv
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; f [Name]
</span><a href="#local-6989586621680807186"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CCEnv -&gt; [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var hs-var">_ccContext</span></a></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="#local-6989586621680807185"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- | Initial environment for expression generation.</span><span>
</span><span id="line-616"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-type">initCCEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-617"></span><span id="initCCEnv"><span class="annot"><span class="annottext">initCCEnv :: CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-var hs-var">initCCEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCEnv :: [Name] -&gt; [Name] -&gt; CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_ccNameSupply :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccNameSupply"><span class="hs-identifier hs-var">_ccNameSupply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Name) -&gt; [VerboseLevel] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;v&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- DON'T CHANGE THESE NAMES!</span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">_ccContext :: [Name]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#_ccContext"><span class="hs-identifier hs-var">_ccContext</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span class="hs-comment">-- | Term variables are de Bruijn indices.</span><span>
</span><span id="line-623"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-type">lookupIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCContext"><span class="hs-identifier hs-type">CCContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span>
</span><span id="line-624"></span><span id="lookupIndex"><span class="annot"><span class="annottext">lookupIndex :: VerboseLevel -&gt; [Name] -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-var hs-var">lookupIndex</span></a></span></span><span> </span><span id="local-6989586621680807181"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807181"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680807180"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807180"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Name -&gt; Name
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; Name) -&gt; Maybe Name -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807180"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; VerboseLevel -&gt; Maybe Name
forall a. [a] -&gt; VerboseLevel -&gt; Maybe a
</span><a href="Agda.Utils.List.html#%21%21%21"><span class="hs-operator hs-var">!!!</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807181"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="hs-comment">-- | Constructor coverage monad transformer</span><span>
</span><span id="line-627"></span><span class="hs-keyword">type</span><span> </span><span id="CCT"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-var">CCT</span></a></span></span><span> </span><span id="local-6989586621680807178"><span class="annot"><a href="#local-6989586621680807178"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCEnv"><span class="hs-identifier hs-type">CCEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807178"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span class="hs-comment">-- | Constructor coverage monad</span><span>
</span><span id="line-630"></span><span class="hs-keyword">type</span><span> </span><span id="CC"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-var">CC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span id="local-6989586621680807849"><span id="local-6989586621680807850"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-type">liftCC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileT"><span class="hs-identifier hs-type">HsCompileT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807849"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807849"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-633"></span><span id="liftCC"><span class="annot"><span class="annottext">liftCC :: HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var hs-var">liftCC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WriterT UsesFloat (HsCompileT m) a -&gt; CCT m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(WriterT UsesFloat (HsCompileT m) a -&gt; CCT m a)
-&gt; (HsCompileT m a -&gt; WriterT UsesFloat (HsCompileT m) a)
-&gt; HsCompileT m a
-&gt; CCT m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HsCompileT m a -&gt; WriterT UsesFloat (HsCompileT m) a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span id="local-6989586621680807867"><span id="local-6989586621680807868"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-type">freshNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807867"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807868"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807867"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-636"></span><span id="freshNames"><span class="annot"><span class="annottext">freshNames :: VerboseLevel -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var hs-var">freshNames</span></a></span></span><span> </span><span id="local-6989586621680807174"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807174"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807174"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CCT m a
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-637"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span> </span><span id="local-6989586621680807172"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807172"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680807171"><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621680807171"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680807170"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807170"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807169"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807169"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [Name] -&gt; ([Name], [Name])
forall a. VerboseLevel -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807172"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; ([Name], [Name]))
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) [Name]
-&gt; ReaderT
     CCEnv (WriterT UsesFloat (HsCompileT m)) ([Name], [Name])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT m)) [Name]
forall o (m :: * -&gt; *) i. MonadReader o m =&gt; Lens' i o -&gt; m i
</span><a href="Agda.Utils.Lens.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var">ccNameSupply</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="annot"><span class="annottext">(CCEnv -&gt; CCEnv) -&gt; CCT m a -&gt; CCT m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' [Name] CCEnv -&gt; LensMap [Name] CCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccNameSupply"><span class="hs-identifier hs-var">ccNameSupply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807169"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CCT m a -&gt; CCT m a) -&gt; CCT m a -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621680807171"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807170"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="hs-comment">-- | Introduce n variables into the context.</span><span>
</span><span id="line-642"></span><span id="local-6989586621680807162"><span id="local-6989586621680807163"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-type">intros</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807163"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Name"><span class="hs-identifier hs-type">HS.Name</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807163"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807162"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807163"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807162"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-643"></span><span id="intros"><span class="annot"><span class="annottext">intros :: VerboseLevel -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var hs-var">intros</span></a></span></span><span> </span><span id="local-6989586621680807160"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807160"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680807159"><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621680807159"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
forall (m :: * -&gt; *) a.
Monad m =&gt;
VerboseLevel -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807160"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CCT m a) -&gt; CCT m a) -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680807158"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807158"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-644"></span><span>  </span><span class="annot"><span class="annottext">(CCEnv -&gt; CCEnv) -&gt; CCT m a -&gt; CCT m a
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">local</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' [Name] CCEnv -&gt; LensMap [Name] CCEnv
forall i o. Lens' i o -&gt; LensMap i o
</span><a href="Agda.Utils.Lens.html#over"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var">ccContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; [Name]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807158"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Name] -&gt; [Name]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CCT m a -&gt; CCT m a) -&gt; CCT m a -&gt; CCT m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; CCT m a
</span><a href="#local-6989586621680807159"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807158"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-type">checkConstructorType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-647"></span><span id="checkConstructorType"><span class="annot"><span class="annottext">checkConstructorType :: QName
-&gt; String -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkConstructorType"><span class="hs-identifier hs-var hs-var">checkConstructorType</span></a></span></span><span> </span><span id="local-6989586621680807156"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807156"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680807155"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807155"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-648"></span><span>  </span><span id="local-6989586621680807154"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807154"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileM Type
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#haskellType"><span class="hs-identifier hs-var">haskellType</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807156"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-649"></span><span>  </span><span class="annot"><span class="annottext">[Decl] -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;check&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807156"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680807154"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-650"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;check&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807156"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-651"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Rhs) -&gt; Exp -&gt; Rhs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeExp"><span class="hs-identifier hs-var">fakeExp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807155"><span class="hs-identifier hs-var">hs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-652"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span id="local-6989586621680807895"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-type">checkCover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Signature.html#HasConstInfo"><span class="hs-identifier hs-type">HasConstInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807895"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellType"><span class="hs-identifier hs-type">HaskellType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Pragmas.html#HaskellCode"><span class="hs-identifier hs-type">HaskellCode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680807895"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-655"></span><span id="checkCover"><span class="annot"><span class="annottext">checkCover :: QName -&gt; String -&gt; VerboseLevel -&gt; [QName] -&gt; [String] -&gt; m [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#checkCover"><span class="hs-identifier hs-var hs-var">checkCover</span></a></span></span><span> </span><span id="local-6989586621680807152"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807152"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680807151"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807151"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680807150"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807150"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680807149"><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807149"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621680807148"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807148"><span class="hs-identifier hs-var">hsCons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807147"><span class="annot"><span class="annottext">tvs :: [String]
</span><a href="#local-6989586621680807147"><span class="hs-identifier hs-var hs-var">tvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807146"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680807146"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807146"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807150"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-657"></span><span>      </span><span id="local-6989586621680807145"><span class="annot"><span class="annottext">makeClause :: QName -&gt; String -&gt; m Alt
</span><a href="#local-6989586621680807145"><span class="hs-identifier hs-var hs-var">makeClause</span></a></span></span><span> </span><span id="local-6989586621680807144"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807144"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680807143"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807143"><span class="hs-identifier hs-var">hsc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-658"></span><span>        </span><span id="local-6989586621680807142"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807142"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; m VerboseLevel
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m VerboseLevel
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#erasedArity"><span class="hs-identifier hs-var">erasedArity</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807144"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-659"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807140"><span class="annot"><span class="annottext">pat :: Pat
</span><a href="#local-6989586621680807140"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807143"><span class="hs-identifier hs-var">hsc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Pat] -&gt; Pat) -&gt; [Pat] -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; Pat -&gt; [Pat]
forall a. VerboseLevel -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807142"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span>
</span><span id="line-660"></span><span>        </span><span class="annot"><span class="annottext">Alt -&gt; m Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt -&gt; m Alt) -&gt; Alt -&gt; m Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621680807140"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Rhs) -&gt; Exp -&gt; Rhs
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-661"></span><span>
</span><span id="line-662"></span><span>  </span><span id="local-6989586621680807135"><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621680807135"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(QName -&gt; String -&gt; m Alt) -&gt; [QName] -&gt; [String] -&gt; m [Alt]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><span class="hs-identifier hs-var">zipWithM</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String -&gt; m Alt
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; String -&gt; m Alt
</span><a href="#local-6989586621680807145"><span class="hs-identifier hs-var">makeClause</span></a></span><span> </span><span class="annot"><span class="annottext">[QName]
</span><a href="#local-6989586621680807149"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807148"><span class="hs-identifier hs-var">hsCons</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807134"><span class="annot"><span class="annottext">rhs :: Exp
</span><a href="#local-6989586621680807134"><span class="hs-identifier hs-var hs-var">rhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Alt] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Case"><span class="hs-identifier hs-var">HS.Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621680807135"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-664"></span><span>
</span><span id="line-665"></span><span>  </span><span class="annot"><span class="annottext">[Decl] -&gt; m [Decl]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeSig"><span class="hs-identifier hs-var">HS.TypeSig</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cover&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807152"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Decl) -&gt; Type -&gt; Decl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeType"><span class="hs-identifier hs-var">fakeType</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Type) -&gt; String -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807151"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680807147"><span class="hs-identifier hs-var">tvs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -&gt; ()&quot;</span></span><span>
</span><span id="line-666"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cover&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807152"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; Name -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-667"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807134"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-668"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-type">closedTerm_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-671"></span><span id="closedTerm_"><span class="annot"><span class="annottext">closedTerm_ :: TTerm -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm_"><span class="hs-identifier hs-var hs-var">closedTerm_</span></a></span></span><span> </span><span id="local-6989586621680807129"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807129"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp, UsesFloat) -&gt; Exp
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Exp, UsesFloat) -&gt; Exp)
-&gt; HsCompileM (Exp, UsesFloat)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var">closedTerm</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807129"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-type">closedTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#UsesFloat"><span class="hs-identifier hs-type">UsesFloat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span id="closedTerm"><span class="annot"><span class="annottext">closedTerm :: TTerm -&gt; HsCompileM (Exp, UsesFloat)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#closedTerm"><span class="hs-identifier hs-var hs-var">closedTerm</span></a></span></span><span> </span><span id="local-6989586621680807128"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807128"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-675"></span><span>  </span><span id="local-6989586621680807127"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807127"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM TTerm -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) TTerm
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM TTerm
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) TTerm)
-&gt; TCM TTerm
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TCM TTerm
forall (m :: * -&gt; *). HasConstInfo m =&gt; TTerm -&gt; m TTerm
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#addCoercions"><span class="hs-identifier hs-var">addCoercions</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807128"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-676"></span><span>  </span><span class="annot"><span class="annottext">WriterT UsesFloat (HsCompileT TCM) Exp
-&gt; HsCompileM (Exp, UsesFloat)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var hs-var">runWriterT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807127"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">CC Exp -&gt; CCEnv -&gt; WriterT UsesFloat (HsCompileT TCM) Exp
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-operator hs-var hs-var">`runReaderT`</span></span><span> </span><span class="annot"><span class="annottext">CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#initCCEnv"><span class="hs-identifier hs-var">initCCEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">-- Translate case on bool to if</span><span>
</span><span id="line-679"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-type">mkIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span>
</span><span id="line-680"></span><span id="mkIf"><span class="annot"><span class="annottext">mkIf :: TTerm -&gt; CC TTerm
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var hs-var">mkIf</span></a></span></span><span> </span><span id="local-6989586621680807122"><span class="annot"><span class="annottext">t :: TTerm
</span><a href="#local-6989586621680807122"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCase"><span class="hs-identifier hs-type">TCase</span></a></span><span> </span><span id="local-6989586621680807120"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807120"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">CaseInfo
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680807119"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807119"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">TACon</span></a></span><span> </span><span id="local-6989586621680807117"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807117"><span class="hs-identifier hs-var">c1</span></a></span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621680807116"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807116"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">TACon</span></a></span><span> </span><span id="local-6989586621680807115"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807115"><span class="hs-identifier hs-var">c2</span></a></span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span id="local-6989586621680807114"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807114"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; Bool
forall a. Unreachable a =&gt; a -&gt; Bool
</span><a href="Agda.Syntax.Treeless.html#isUnreachable"><span class="hs-identifier hs-var">T.isUnreachable</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807119"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-681"></span><span>  </span><span id="local-6989586621680807112"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807112"><span class="hs-identifier hs-var">mTrue</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
 -&gt; CCT TCM (Maybe QName))
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinTrue"><span class="hs-identifier hs-var">builtinTrue</span></a></span><span>
</span><span id="line-682"></span><span>  </span><span id="local-6989586621680807111"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807111"><span class="hs-identifier hs-var">mFalse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
 -&gt; CCT TCM (Maybe QName))
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinFalse"><span class="hs-identifier hs-var">builtinFalse</span></a></span><span>
</span><span id="line-683"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807110"><span class="annot"><span class="annottext">isTrue :: QName -&gt; Bool
</span><a href="#local-6989586621680807110"><span class="hs-identifier hs-var hs-var">isTrue</span></a></span></span><span>  </span><span id="local-6989586621680807109"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807109"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807109"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807112"><span class="hs-identifier hs-var">mTrue</span></a></span><span>
</span><span id="line-684"></span><span>      </span><span id="local-6989586621680807108"><span class="annot"><span class="annottext">isFalse :: QName -&gt; Bool
</span><a href="#local-6989586621680807108"><span class="hs-identifier hs-var hs-var">isFalse</span></a></span></span><span> </span><span id="local-6989586621680807107"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807107"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807107"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807111"><span class="hs-identifier hs-var">mFalse</span></a></span><span>
</span><span id="line-685"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621680807110"><span class="hs-identifier hs-var">isTrue</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807117"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621680807108"><span class="hs-identifier hs-var">isFalse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807115"><span class="hs-identifier hs-var">c2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC TTerm) -&gt; TTerm -&gt; CC TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TTerm -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#tIfThenElse"><span class="hs-identifier hs-var">T.tIfThenElse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-var">TCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807120"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807116"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807114"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-686"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621680807110"><span class="hs-identifier hs-var">isTrue</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807115"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Bool
</span><a href="#local-6989586621680807108"><span class="hs-identifier hs-var">isFalse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807117"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC TTerm) -&gt; TTerm -&gt; CC TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; TTerm -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#tIfThenElse"><span class="hs-identifier hs-var">T.tIfThenElse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-var">TCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">TVar</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807120"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807114"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807116"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-687"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807122"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-688"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var">mkIf</span></a></span><span> </span><span id="local-6989586621680807103"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807103"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807103"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span class="hs-comment">-- | Extract Agda term to Haskell expression.</span><span>
</span><span id="line-691"></span><span class="hs-comment">--   Erased arguments are extracted as @()@.</span><span>
</span><span id="line-692"></span><span class="hs-comment">--   Types are extracted as @()@.</span><span>
</span><span id="line-693"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-type">term</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-694"></span><span id="term"><span class="annot"><span class="annottext">term :: TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span> </span><span id="local-6989586621680807102"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807102"><span class="hs-identifier hs-var">tm0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC TTerm
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#mkIf"><span class="hs-identifier hs-var">mkIf</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807102"><span class="hs-identifier hs-var">tm0</span></a></span><span> </span><span class="annot"><span class="annottext">CC TTerm -&gt; (TTerm -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807101"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807101"><span class="hs-identifier hs-var">tm0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-695"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680807100"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807100"><span class="hs-identifier hs-var">hasCoerce</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807099"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807099"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807098"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807098"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; ((Bool, TTerm), [TTerm])
</span><a href="Agda.Syntax.Treeless.html#coerceAppView"><span class="hs-identifier hs-var">coerceAppView</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807101"><span class="hs-identifier hs-var">tm0</span></a></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-comment">-- let (t0, ts)       = tAppView tm0</span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-comment">-- let (hasCoerce, t) = coerceView t0</span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807096"><span class="annot"><span class="annottext">coe :: Exp -&gt; Exp
</span><a href="#local-6989586621680807096"><span class="hs-identifier hs-var hs-var">coe</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Exp -&gt; Exp) -&gt; Exp -&gt; Exp
forall a. Bool -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Agda.Utils.Function.html#applyWhen"><span class="hs-identifier hs-var">applyWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807100"><span class="hs-identifier hs-var">hasCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807099"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807098"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PIf"><span class="hs-identifier hs-var">T.PIf</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680807092"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807092"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807091"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807091"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807090"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807090"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621680807096"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#If"><span class="hs-identifier hs-var">HS.If</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp -&gt; Exp)
-&gt; CC Exp
-&gt; ReaderT
     CCEnv (WriterT UsesFloat (HsCompileT TCM)) (Exp -&gt; Exp -&gt; Exp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807092"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT
  CCEnv (WriterT UsesFloat (HsCompileT TCM)) (Exp -&gt; Exp -&gt; Exp)
-&gt; CC Exp
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) (Exp -&gt; Exp)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807091"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) (Exp -&gt; Exp)
-&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807090"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TDef"><span class="hs-identifier hs-type">T.TDef</span></a></span><span> </span><span id="local-6989586621680807087"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807087"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807086"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807086"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-703"></span><span>      </span><span id="local-6989586621680807085"><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807085"><span class="hs-identifier hs-var">used</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) [ArgUsage]
-&gt; CCT TCM [ArgUsage]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) [ArgUsage]
 -&gt; CCT TCM [ArgUsage])
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [ArgUsage]
-&gt; CCT TCM [ArgUsage]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; Maybe [ArgUsage] -&gt; [ArgUsage]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [ArgUsage] -&gt; [ArgUsage])
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) [ArgUsage]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName
-&gt; ReaderT
     HsModuleEnv (StateT HsCompileState TCM) (Maybe [ArgUsage])
forall (m :: * -&gt; *).
HasConstInfo m =&gt;
QName -&gt; m (Maybe [ArgUsage])
</span><a href="Agda.TypeChecking.Monad.Signature.html#getCompiledArgUse"><span class="hs-identifier hs-var">getCompiledArgUse</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807087"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-704"></span><span>      </span><span class="hs-comment">-- #2248: no unused argument pruning for COMPILE'd functions</span><span>
</span><span id="line-705"></span><span>      </span><span id="local-6989586621680807084"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807084"><span class="hs-identifier hs-var">isCompiled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM Bool -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Bool
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM Bool
 -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Bool)
-&gt; TCM Bool
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe HaskellPragma -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe HaskellPragma -&gt; Bool)
-&gt; TCM (Maybe HaskellPragma) -&gt; TCM Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM (Maybe HaskellPragma)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellPragma"><span class="hs-identifier hs-var">getHaskellPragma</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807087"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-706"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807082"><span class="annot"><span class="annottext">given :: VerboseLevel
</span><a href="#local-6989586621680807082"><span class="hs-identifier hs-var hs-var">given</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TTerm] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807086"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-707"></span><span>          </span><span id="local-6989586621680807081"><span class="annot"><span class="annottext">needed :: VerboseLevel
</span><a href="#local-6989586621680807081"><span class="hs-identifier hs-var hs-var">needed</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807085"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-708"></span><span>          </span><span id="local-6989586621680807080"><span class="annot"><span class="annottext">missing :: [ArgUsage]
</span><a href="#local-6989586621680807080"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [ArgUsage] -&gt; [ArgUsage]
forall a. VerboseLevel -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807082"><span class="hs-identifier hs-var">given</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807085"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-709"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680807084"><span class="hs-identifier hs-var">isCompiled</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="annot"><span class="annottext">ArgUsage -&gt; [ArgUsage] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807085"><span class="hs-identifier hs-var">used</span></a></span><span>
</span><span id="line-710"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ArgUsage
</span><a href="Agda.Syntax.Treeless.html#ArgUnused"><span class="hs-identifier hs-var">ArgUnused</span></a></span><span> </span><span class="annot"><span class="annottext">ArgUsage -&gt; [ArgUsage] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807080"><span class="hs-identifier hs-var">missing</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm -&gt; TTerm
</span><a href="#local-6989586621680807078"><span class="hs-identifier hs-var">etaExpand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807081"><span class="hs-identifier hs-var">needed</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807082"><span class="hs-identifier hs-var">given</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807101"><span class="hs-identifier hs-var">tm0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-711"></span><span>          </span><span id="local-6989586621680807077"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807077"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var">xhqn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;du&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807087"><span class="hs-identifier hs-var">f</span></a></span><span>  </span><span class="hs-comment">-- use stripped function</span><span>
</span><span id="line-712"></span><span>          </span><span class="hs-comment">-- Andreas, 2019-11-07, issue #4169.</span><span>
</span><span id="line-713"></span><span>          </span><span class="hs-comment">-- Insert coercion unconditionally as erasure of arguments</span><span>
</span><span id="line-714"></span><span>          </span><span class="hs-comment">-- that are matched upon might remove the unfolding of codomain types.</span><span>
</span><span id="line-715"></span><span>          </span><span class="hs-comment">-- (Hard to explain, see test/Compiler/simple/Issue4169.)</span><span>
</span><span id="line-716"></span><span>          </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807077"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621680807075"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage] -&gt; [TTerm] -&gt; [TTerm]
forall a. [ArgUsage] -&gt; [a] -&gt; [a]
</span><a href="Agda.Syntax.Treeless.html#filterUsed"><span class="hs-identifier hs-var">filterUsed</span></a></span><span> </span><span class="annot"><span class="annottext">[ArgUsage]
</span><a href="#local-6989586621680807085"><span class="hs-identifier hs-var">used</span></a></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807086"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-717"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-718"></span><span>          </span><span id="local-6989586621680807074"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807074"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#xhqn"><span class="hs-identifier hs-var">xhqn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807087"><span class="hs-identifier hs-var">f</span></a></span><span>  </span><span class="hs-comment">-- use original (non-stripped) function</span><span>
</span><span id="line-719"></span><span>          </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621680807096"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807074"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621680807075"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807086"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCon"><span class="hs-identifier hs-type">T.TCon</span></a></span><span> </span><span id="local-6989586621680807072"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807072"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807071"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807071"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-722"></span><span>      </span><span id="local-6989586621680807070"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807070"><span class="hs-identifier hs-var">erased</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileT TCM [Bool] -&gt; CCT TCM [Bool])
-&gt; HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileT TCM [Bool]
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m [Bool]
</span><a href="Agda.TypeChecking.Monad.Signature.html#getErasedConArgs"><span class="hs-identifier hs-var">getErasedConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807072"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-723"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807068"><span class="annot"><span class="annottext">missing :: [Bool]
</span><a href="#local-6989586621680807068"><span class="hs-identifier hs-var hs-var">missing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [Bool] -&gt; [Bool]
forall a. VerboseLevel -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TTerm] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807071"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807070"><span class="hs-identifier hs-var">erased</span></a></span><span>
</span><span id="line-724"></span><span>          </span><span id="local-6989586621680807067"><span class="annot"><span class="annottext">notErased :: Bool -&gt; Bool
</span><a href="#local-6989586621680807067"><span class="hs-identifier hs-var hs-var">notErased</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span>
</span><span id="line-725"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; [Bool] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="#local-6989586621680807067"><span class="hs-identifier hs-var">notErased</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807068"><span class="hs-identifier hs-var">missing</span></a></span><span>
</span><span id="line-726"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-727"></span><span>                </span><span id="local-6989586621680807065"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807065"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Con"><span class="hs-identifier hs-var">HS.Con</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-var">conhqn</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807072"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-728"></span><span>                </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807065"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621680807075"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807062"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680807062"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807062"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TTerm] -&gt; [Bool] -&gt; [(TTerm, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807071"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807070"><span class="hs-identifier hs-var">erased</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-729"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-730"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807061"><span class="annot"><span class="annottext">n :: VerboseLevel
</span><a href="#local-6989586621680807061"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807068"><span class="hs-identifier hs-var">missing</span></a></span><span>
</span><span id="line-731"></span><span>                </span><span class="annot"><span class="annottext">Bool
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) ()
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807061"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) ()
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>  </span><span class="hs-comment">-- We will add at least on TLam, not getting a busy loop here.</span><span>
</span><span id="line-732"></span><span>                </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm -&gt; TTerm
</span><a href="#local-6989586621680807078"><span class="hs-identifier hs-var">etaExpand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; VerboseLevel
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; VerboseLevel
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807068"><span class="hs-identifier hs-var">missing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807101"><span class="hs-identifier hs-var">tm0</span></a></span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span>    </span><span class="hs-comment">-- Other kind of application: fall back to apps.</span><span>
</span><span id="line-735"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680807059"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807059"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680807058"><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807058"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-var">noApplication</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807059"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">CC Exp -&gt; (Exp -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807056"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807056"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="#local-6989586621680807096"><span class="hs-identifier hs-var">coe</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807056"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621680807075"><span class="hs-operator hs-var">`apps`</span></a></span><span> </span><span class="annot"><span class="annottext">[TTerm]
</span><a href="#local-6989586621680807058"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-736"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-737"></span><span>  </span><span id="local-6989586621680807075"><span class="annot"><span class="annottext">apps :: Exp -&gt; [TTerm] -&gt; CC Exp
</span><a href="#local-6989586621680807075"><span class="hs-identifier hs-var hs-var">apps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; TTerm -&gt; CC Exp) -&gt; Exp -&gt; [TTerm] -&gt; CC Exp
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807054"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807054"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621680807053"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807053"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807054"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807053"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>  </span><span id="local-6989586621680807078"><span class="annot"><span class="annottext">etaExpand :: VerboseLevel -&gt; TTerm -&gt; TTerm
</span><a href="#local-6989586621680807078"><span class="hs-identifier hs-var hs-var">etaExpand</span></a></span></span><span> </span><span id="local-6989586621680807052"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807052"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680807051"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807051"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#mkTLam"><span class="hs-identifier hs-var">mkTLam</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807052"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; TTerm) -&gt; TTerm -&gt; TTerm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm -&gt; TTerm
forall a. Subst a =&gt; VerboseLevel -&gt; a -&gt; a
</span><a href="Agda.TypeChecking.Substitute.Class.html#raise"><span class="hs-identifier hs-var">raise</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807052"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807051"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; [TTerm] -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#mkTApp"><span class="hs-operator hs-var">`T.mkTApp`</span></a></span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; TTerm) -&gt; [VerboseLevel] -&gt; [TTerm]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">T.TVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; [VerboseLevel]
forall a. Integral a =&gt; a -&gt; [a]
</span><a href="Agda.Utils.List.html#downFrom"><span class="hs-identifier hs-var">downFrom</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807052"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="hs-comment">-- | Translate a non-application, non-coercion, non-constructor, non-definition term.</span><span>
</span><span id="line-741"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-type">noApplication</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TTerm"><span class="hs-identifier hs-type">T.TTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-742"></span><span id="noApplication"><span class="annot"><span class="annottext">noApplication :: TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#noApplication"><span class="hs-identifier hs-var hs-var">noApplication</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-743"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TApp"><span class="hs-identifier hs-type">T.TApp</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-744"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCoerce"><span class="hs-identifier hs-type">T.TCoerce</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-745"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCon"><span class="hs-identifier hs-type">T.TCon</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-746"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TDef"><span class="hs-identifier hs-type">T.TDef</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CC Exp
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-type">T.TVar</span></a></span><span> </span><span id="local-6989586621680807045"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807045"><span class="hs-identifier hs-var">i</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; ([Name] -&gt; Name) -&gt; [Name] -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; [Name] -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#lookupIndex"><span class="hs-identifier hs-var">lookupIndex</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807045"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; Exp)
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) [Name]
-&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) [Name]
forall o (m :: * -&gt; *) i. MonadReader o m =&gt; Lens' i o -&gt; m i
</span><a href="Agda.Utils.Lens.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' [Name] CCEnv
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ccContext"><span class="hs-identifier hs-var">ccContext</span></a></span><span>
</span><span id="line-749"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLam"><span class="hs-identifier hs-type">T.TLam</span></a></span><span> </span><span id="local-6989586621680807044"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807044"><span class="hs-identifier hs-var">t</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a.
Monad m =&gt;
VerboseLevel -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CC Exp) -&gt; CC Exp) -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680807043"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807043"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Pat] -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLambda"><span class="hs-identifier hs-var">hsLambda</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807043"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807044"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLet"><span class="hs-identifier hs-type">T.TLet</span></a></span><span> </span><span id="local-6989586621680807040"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807040"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680807039"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807039"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-752"></span><span>    </span><span id="local-6989586621680807038"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807038"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807040"><span class="hs-identifier hs-var">t1</span></a></span><span>
</span><span id="line-753"></span><span>    </span><span class="annot"><span class="annottext">VerboseLevel -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall (m :: * -&gt; *) a.
Monad m =&gt;
VerboseLevel -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; CC Exp) -&gt; CC Exp) -&gt; ([Name] -&gt; CC Exp) -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">[</span><span id="local-6989586621680807037"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807037"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-754"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsLet"><span class="hs-identifier hs-var">hsLet</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680807037"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807038"><span class="hs-identifier hs-var">t1'</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; CC Exp -&gt; CC Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807039"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TCase"><span class="hs-identifier hs-type">T.TCase</span></a></span><span> </span><span id="local-6989586621680807035"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807035"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621680807034"><span class="annot"><span class="annottext">CaseInfo
</span><a href="#local-6989586621680807034"><span class="hs-identifier hs-var">ct</span></a></span></span><span> </span><span id="local-6989586621680807033"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807033"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621680807032"><span class="annot"><span class="annottext">[TAlt]
</span><a href="#local-6989586621680807032"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-757"></span><span>    </span><span id="local-6989586621680807031"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807031"><span class="hs-identifier hs-var">sc'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#TVar"><span class="hs-identifier hs-var">T.TVar</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807035"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-758"></span><span>    </span><span id="local-6989586621680807030"><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621680807030"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TAlt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
-&gt; [TAlt]
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) [Alt]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel
-&gt; TAlt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807035"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TAlt]
</span><a href="#local-6989586621680807032"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-759"></span><span>    </span><span id="local-6989586621680807027"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807027"><span class="hs-identifier hs-var">def'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680807033"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-760"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680807026"><span class="annot"><span class="annottext">defAlt :: Alt
</span><a href="#local-6989586621680807026"><span class="hs-identifier hs-var hs-var">defAlt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807027"><span class="hs-identifier hs-var">def'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Alt] -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Case"><span class="hs-identifier hs-var">HS.Case</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var">hsCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807031"><span class="hs-identifier hs-var">sc'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Alt]
</span><a href="#local-6989586621680807030"><span class="hs-identifier hs-var">alts'</span></a></span><span> </span><span class="annot"><span class="annottext">[Alt] -&gt; [Alt] -&gt; [Alt]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Alt
</span><a href="#local-6989586621680807026"><span class="hs-identifier hs-var">defAlt</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>
</span><span id="line-763"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TLit"><span class="hs-identifier hs-type">T.TLit</span></a></span><span> </span><span id="local-6989586621680807024"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680807024"><span class="hs-identifier hs-var">l</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CC Exp
forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680807024"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-764"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span id="local-6989586621680807022"><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621680807022"><span class="hs-identifier hs-var">p</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-var">compilePrim</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621680807022"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-765"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TUnit"><span class="hs-identifier hs-var">T.TUnit</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span>
</span><span id="line-766"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TSort"><span class="hs-identifier hs-var">T.TSort</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span>
</span><span id="line-767"></span><span>  </span><span class="annot"><span class="annottext">TTerm
</span><a href="Agda.Syntax.Treeless.html#TErased"><span class="hs-identifier hs-var">T.TErased</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Exp) -&gt; Name -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazErasedName"><span class="hs-identifier hs-var">mazErasedName</span></a></span><span>
</span><span id="line-768"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TError"><span class="hs-identifier hs-type">T.TError</span></a></span><span> </span><span id="local-6989586621680807017"><span class="annot"><span class="annottext">TError
</span><a href="#local-6989586621680807017"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CC Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CC Exp) -&gt; Exp -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TError
</span><a href="#local-6989586621680807017"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-769"></span><span>    </span><span class="annot"><span class="annottext">TError
</span><a href="Agda.Syntax.Treeless.html#TUnreachable"><span class="hs-identifier hs-var">T.TUnreachable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmUnreachableError"><span class="hs-identifier hs-var">rtmUnreachableError</span></a></span><span>
</span><span id="line-770"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TMeta"><span class="hs-identifier hs-type">T.TMeta</span></a></span><span> </span><span id="local-6989586621680807013"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807013"><span class="hs-identifier hs-var">s</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmHole"><span class="hs-identifier hs-var">rtmHole</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680807013"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-type">hsCoerce</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-773"></span><span id="hsCoerce"><span class="annot"><span class="annottext">hsCoerce :: Exp -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hsCoerce"><span class="hs-identifier hs-var hs-var">hsCoerce</span></a></span></span><span> </span><span id="local-6989586621680807011"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807011"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazCoerce"><span class="hs-identifier hs-var">mazCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680807011"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-type">compilePrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TPrim"><span class="hs-identifier hs-type">T.TPrim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-776"></span><span id="compilePrim"><span class="annot"><span class="annottext">compilePrim :: TPrim -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compilePrim"><span class="hs-identifier hs-var hs-var">compilePrim</span></a></span></span><span> </span><span id="local-6989586621680807009"><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621680807009"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; QName) -&gt; String -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TPrim -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="#local-6989586621680807009"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-type">alt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TAlt"><span class="hs-identifier hs-type">T.TAlt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span>
</span><span id="line-779"></span><span id="alt"><span class="annot"><span class="annottext">alt :: VerboseLevel
-&gt; TAlt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#alt"><span class="hs-identifier hs-var hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621680807007"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680807007"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621680807006"><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621680807006"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621680807006"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-781"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TACon"><span class="hs-identifier hs-type">T.TACon</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">aCon :: TAlt -&gt; QName
</span><a href="Agda.Syntax.Treeless.html#aCon"><span class="hs-identifier hs-var">T.aCon</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680807004"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807004"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-782"></span><span>      </span><span class="annot"><span class="annottext">VerboseLevel
-&gt; ([Name]
    -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall (m :: * -&gt; *) a.
Monad m =&gt;
VerboseLevel -&gt; ([Name] -&gt; CCT m a) -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#intros"><span class="hs-identifier hs-var">intros</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TAlt -&gt; VerboseLevel
</span><a href="Agda.Syntax.Treeless.html#aArity"><span class="hs-identifier hs-var hs-var">T.aArity</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621680807006"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([Name] -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
 -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
-&gt; ([Name]
    -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680807002"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807002"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-783"></span><span>        </span><span id="local-6989586621680807001"><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807001"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(HsCompileT TCM [Bool] -&gt; CCT TCM [Bool])
-&gt; HsCompileT TCM [Bool] -&gt; CCT TCM [Bool]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; HsCompileT TCM [Bool]
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m [Bool]
</span><a href="Agda.TypeChecking.Monad.Signature.html#getErasedConArgs"><span class="hs-identifier hs-var">getErasedConArgs</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807004"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-784"></span><span>        </span><span id="local-6989586621680807000"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807000"><span class="hs-identifier hs-var">nil</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
 -&gt; CCT TCM (Maybe QName))
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinNil"><span class="hs-identifier hs-var">builtinNil</span></a></span><span>
</span><span id="line-785"></span><span>        </span><span id="local-6989586621680806999"><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680806999"><span class="hs-identifier hs-var">cons</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
 -&gt; CCT TCM (Maybe QName))
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
-&gt; CCT TCM (Maybe QName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) (Maybe QName)
forall (m :: * -&gt; *).
(HasBuiltins m, MonadReduce m) =&gt;
String -&gt; m (Maybe QName)
</span><a href="Agda.TypeChecking.Primitive.Base.html#getBuiltinName"><span class="hs-identifier hs-var">getBuiltinName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Agda.Syntax.Builtin.html#builtinCons"><span class="hs-identifier hs-var">builtinCons</span></a></span><span>
</span><span id="line-786"></span><span>        </span><span id="local-6989586621680806998"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806998"><span class="hs-identifier hs-var">hConNm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-787"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807004"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680807000"><span class="hs-identifier hs-var">nil</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName)
-&gt; QName
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[]&quot;</span></span><span>
</span><span id="line-788"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Maybe QName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807004"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe QName -&gt; Maybe QName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe QName
</span><a href="#local-6989586621680806999"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName)
-&gt; QName
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Symbol"><span class="hs-identifier hs-var">HS.Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-789"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName
forall (m :: * -&gt; *) a. Monad m =&gt; HsCompileT m a -&gt; CCT m a
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#liftCC"><span class="hs-identifier hs-var">liftCC</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
 -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName)
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#conhqn"><span class="hs-identifier hs-var">conhqn</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680807004"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-790"></span><span>        </span><span class="annot"><span class="annottext">Pat -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="#local-6989586621680806996"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806998"><span class="hs-identifier hs-var">hConNm</span></a></span><span> </span><span class="annot"><span class="annottext">([Pat] -&gt; Pat) -&gt; [Pat] -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806995"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680806995"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806995"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; [Bool] -&gt; [(Name, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680807002"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool]
</span><a href="#local-6989586621680807001"><span class="hs-identifier hs-var">erased</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TAGuard"><span class="hs-identifier hs-type">T.TAGuard</span></a></span><span> </span><span id="local-6989586621680806993"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806993"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621680806992"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806992"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-792"></span><span>      </span><span id="local-6989586621680806991"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806991"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806993"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-793"></span><span>      </span><span id="local-6989586621680806990"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806990"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806992"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-794"></span><span>      </span><span class="annot"><span class="annottext">Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
-&gt; Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span>
</span><span id="line-795"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GuardedRhs] -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-var">HS.GuardedRhss</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Stmt] -&gt; Exp -&gt; GuardedRhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-var">HS.GuardedRhs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><a href="Agda.Utils.Haskell.Syntax.html#Qualifier"><span class="hs-identifier hs-var">HS.Qualifier</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806991"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806990"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>                      </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-797"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span> </span><span id="local-6989586621680806983"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806983"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="#local-6989586621680806996"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-var">litqnamepat</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806983"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680806981"><span class="annot"><span class="annottext">l :: Literal
</span><a href="#local-6989586621680806981"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aBody :: TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680806978"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806978"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-799"></span><span>      </span><span class="annot"><span class="annottext">UsesFloat -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-var">YesFloat</span></a></span><span>
</span><span id="line-800"></span><span>      </span><span id="local-6989586621680806976"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806976"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; CC Exp
forall (m :: * -&gt; *). Monad m =&gt; Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var">literal</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680806981"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-801"></span><span>      </span><span class="annot"><span class="annottext">String
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="#local-6989586621680806975"><span class="hs-identifier hs-var">mkGuarded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TPrim -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Primitives.html#treelessPrimName"><span class="hs-identifier hs-var">treelessPrimName</span></a></span><span> </span><span class="annot"><span class="annottext">TPrim
</span><a href="Agda.Syntax.Treeless.html#PEqF"><span class="hs-identifier hs-var">T.PEqF</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806976"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806978"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-802"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">aLit :: TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var">T.aLit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621680806972"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680806972"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">aBody :: TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var">T.aBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680806971"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806971"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="#local-6989586621680806975"><span class="hs-identifier hs-var">mkGuarded</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(==)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var">litString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680806972"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806971"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-803"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Treeless.html#TALit"><span class="hs-identifier hs-type">T.TALit</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Pat -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="#local-6989586621680806996"><span class="hs-identifier hs-var">mkAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Pat) -&gt; Literal -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var">hslit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Literal) -&gt; Literal -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TAlt -&gt; Literal
</span><a href="Agda.Syntax.Treeless.html#aLit"><span class="hs-identifier hs-var hs-var">T.aLit</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621680807006"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-805"></span><span>    </span><span id="local-6989586621680806975"><span class="annot"><span class="annottext">mkGuarded :: String
-&gt; Exp
-&gt; TTerm
-&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="#local-6989586621680806975"><span class="hs-identifier hs-var hs-var">mkGuarded</span></a></span></span><span> </span><span id="local-6989586621680806967"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806967"><span class="hs-identifier hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621680806966"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806966"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span id="local-6989586621680806965"><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806965"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-806"></span><span>      </span><span id="local-6989586621680806964"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806964"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">TTerm
</span><a href="#local-6989586621680806965"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-807"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806963"><span class="annot"><span class="annottext">varName :: Name
</span><a href="#local-6989586621680806963"><span class="hs-identifier hs-var hs-var">varName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;l&quot;</span></span><span> </span><span class="hs-comment">-- only used locally in the guard</span><span>
</span><span id="line-808"></span><span>          </span><span id="local-6989586621680806962"><span class="annot"><span class="annottext">pv :: Pat
</span><a href="#local-6989586621680806962"><span class="hs-identifier hs-var hs-var">pv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806963"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-809"></span><span>          </span><span id="local-6989586621680806961"><span class="annot"><span class="annottext">v :: Exp
</span><a href="#local-6989586621680806961"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsVarUQ"><span class="hs-identifier hs-var">hsVarUQ</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806963"><span class="hs-identifier hs-var">varName</span></a></span><span>
</span><span id="line-810"></span><span>          </span><span id="local-6989586621680806960"><span class="annot"><span class="annottext">guard :: Exp
</span><a href="#local-6989586621680806960"><span class="hs-identifier hs-var hs-var">guard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-811"></span><span>            </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806967"><span class="hs-identifier hs-var">eq</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span>
</span><span id="line-812"></span><span>              </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806961"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806966"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-813"></span><span>      </span><span class="annot"><span class="annottext">Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
-&gt; Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621680806962"><span class="hs-identifier hs-var">pv</span></a></span><span>
</span><span id="line-814"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[GuardedRhs] -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhss"><span class="hs-identifier hs-var">HS.GuardedRhss</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Stmt] -&gt; Exp -&gt; GuardedRhs
</span><a href="Agda.Utils.Haskell.Syntax.html#GuardedRhs"><span class="hs-identifier hs-var">HS.GuardedRhs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; Stmt
</span><a href="Agda.Utils.Haskell.Syntax.html#Qualifier"><span class="hs-identifier hs-var">HS.Qualifier</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806960"><span class="hs-identifier hs-var">guard</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806964"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>                      </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span>    </span><span class="annot"><a href="#local-6989586621680806996"><span class="hs-identifier hs-type">mkAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CC"><span class="hs-identifier hs-type">CC</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-type">HS.Alt</span></a></span><span>
</span><span id="line-818"></span><span>    </span><span id="local-6989586621680806996"><span class="annot"><span class="annottext">mkAlt :: Pat -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
</span><a href="#local-6989586621680806996"><span class="hs-identifier hs-var hs-var">mkAlt</span></a></span></span><span> </span><span id="local-6989586621680806959"><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621680806959"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-819"></span><span>        </span><span id="local-6989586621680806958"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806958"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TTerm -&gt; CC Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#term"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">(TTerm -&gt; CC Exp) -&gt; TTerm -&gt; CC Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TAlt -&gt; TTerm
</span><a href="Agda.Syntax.Treeless.html#aBody"><span class="hs-identifier hs-var hs-var">T.aBody</span></a></span><span> </span><span class="annot"><span class="annottext">TAlt
</span><a href="#local-6989586621680807006"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-820"></span><span>        </span><span class="annot"><span class="annottext">Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt)
-&gt; Alt -&gt; ReaderT CCEnv (WriterT UsesFloat (HsCompileT TCM)) Alt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Rhs -&gt; Maybe Binds -&gt; Alt
</span><a href="Agda.Utils.Haskell.Syntax.html#Alt"><span class="hs-identifier hs-var">HS.Alt</span></a></span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="#local-6989586621680806959"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806958"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-type">literal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680807830"><span class="annot"><a href="#local-6989586621680807830"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621680807830"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807830"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-823"></span><span id="literal"><span class="annot"><span class="annottext">literal :: Literal -&gt; CCT m Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#literal"><span class="hs-identifier hs-var hs-var">literal</span></a></span></span><span> </span><span id="local-6989586621680806957"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680806957"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680806957"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-824"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806955"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Integer&quot;</span></span><span>
</span><span id="line-825"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitWord64"><span class="hs-identifier hs-type">LitWord64</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806955"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MAlonzo.RTE.Word64&quot;</span></span><span>
</span><span id="line-826"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span>  </span><span id="local-6989586621680806953"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806953"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; String -&gt; CCT m Exp
</span><a href="#local-6989586621680806952"><span class="hs-identifier hs-var">floatExp</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806953"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Double&quot;</span></span><span>
</span><span id="line-827"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span>  </span><span id="local-6989586621680806951"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806951"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-var">litqname</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806951"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-828"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span id="local-6989586621680806949"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680806949"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var">litString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680806949"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-829"></span><span>  </span><span class="annot"><span class="annottext">Literal
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806948"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-831"></span><span>    </span><span id="local-6989586621680806948"><span class="annot"><span class="annottext">l' :: Exp
</span><a href="#local-6989586621680806948"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Exp) -&gt; Literal -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var">hslit</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680806957"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-832"></span><span>    </span><span id="local-6989586621680806955"><span class="annot"><span class="annottext">typed :: String -&gt; Exp
</span><a href="#local-6989586621680806955"><span class="hs-identifier hs-var hs-var">typed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#ExpTypeSig"><span class="hs-identifier hs-var">HS.ExpTypeSig</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680806948"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Exp) -&gt; (String -&gt; Type) -&gt; String -&gt; Exp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Type) -&gt; (String -&gt; QName) -&gt; String -&gt; Type
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#rtmQual"><span class="hs-identifier hs-var">rtmQual</span></a></span><span>
</span><span id="line-833"></span><span>
</span><span id="line-834"></span><span>    </span><span class="hs-comment">-- ASR (2016-09-14): See Issue #2169.</span><span>
</span><span id="line-835"></span><span>    </span><span class="hs-comment">-- Ulf, 2016-09-28: and #2218.</span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="#local-6989586621680806952"><span class="hs-identifier hs-type">floatExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#CCT"><span class="hs-identifier hs-type">CCT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807830"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-837"></span><span>    </span><span id="local-6989586621680806952"><span class="annot"><span class="annottext">floatExp :: Double -&gt; String -&gt; CCT m Exp
</span><a href="#local-6989586621680806952"><span class="hs-identifier hs-var hs-var">floatExp</span></a></span></span><span> </span><span id="local-6989586621680806943"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806943"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680806942"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806942"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-838"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isPosInf"><span class="hs-identifier hs-var">isPosInf</span></a></span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806943"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; CCT m Exp
forall (m :: * -&gt; *). MonadWriter UsesFloat m =&gt; String -&gt; m Exp
</span><a href="#local-6989586621680806940"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;positiveInfinity&quot;</span></span><span>
</span><span id="line-839"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isNegInf"><span class="hs-identifier hs-var">isNegInf</span></a></span><span>  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806943"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; CCT m Exp
forall (m :: * -&gt; *). MonadWriter UsesFloat m =&gt; String -&gt; m Exp
</span><a href="#local-6989586621680806940"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;negativeInfinity&quot;</span></span><span>
</span><span id="line-840"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
</span><a href="Agda.Utils.Float.html#isNegZero"><span class="hs-identifier hs-var">isNegZero</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806943"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; CCT m Exp
forall (m :: * -&gt; *). MonadWriter UsesFloat m =&gt; String -&gt; m Exp
</span><a href="#local-6989586621680806940"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;negativeZero&quot;</span></span><span>
</span><span id="line-841"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span>     </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806943"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; CCT m Exp
forall (m :: * -&gt; *). MonadWriter UsesFloat m =&gt; String -&gt; m Exp
</span><a href="#local-6989586621680806940"><span class="hs-identifier hs-var">rte</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nan&quot;</span></span><span>
</span><span id="line-842"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; CCT m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; CCT m Exp) -&gt; Exp -&gt; CCT m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806955"><span class="hs-identifier hs-var">typed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806942"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-843"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-844"></span><span>        </span><span id="local-6989586621680806940"><span class="annot"><span class="annottext">rte :: String -&gt; m Exp
</span><a href="#local-6989586621680806940"><span class="hs-identifier hs-var hs-var">rte</span></a></span></span><span> </span><span id="local-6989586621680806936"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806936"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">UsesFloat -&gt; m ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">UsesFloat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#YesFloat"><span class="hs-identifier hs-var">YesFloat</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; m Exp
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; m Exp) -&gt; Exp -&gt; m Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Var"><span class="hs-identifier hs-var">HS.Var</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTEFloat"><span class="hs-identifier hs-var">mazRTEFloat</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806936"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-type">hslit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Literal.html#Literal"><span class="hs-identifier hs-type">Literal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Literal"><span class="hs-identifier hs-type">HS.Literal</span></a></span><span>
</span><span id="line-847"></span><span id="hslit"><span class="annot"><span class="annottext">hslit :: Literal -&gt; Literal
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#hslit"><span class="hs-identifier hs-var hs-var">hslit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-848"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitNat"><span class="hs-identifier hs-type">LitNat</span></a></span><span>    </span><span id="local-6989586621680806934"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680806934"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span>    </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680806934"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-849"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitWord64"><span class="hs-identifier hs-type">LitWord64</span></a></span><span> </span><span id="local-6989586621680806932"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806932"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806932"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitFloat"><span class="hs-identifier hs-type">LitFloat</span></a></span><span>  </span><span id="local-6989586621680806931"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806931"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Frac"><span class="hs-identifier hs-var">HS.Frac</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806931"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitChar"><span class="hs-identifier hs-type">LitChar</span></a></span><span>   </span><span id="local-6989586621680806928"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680806928"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Char"><span class="hs-identifier hs-var">HS.Char</span></a></span><span>   </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680806928"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-852"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitQName"><span class="hs-identifier hs-type">LitQName</span></a></span><span>  </span><span id="local-6989586621680806926"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806926"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-853"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitString"><span class="hs-identifier hs-type">LitString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-854"></span><span>  </span><span class="annot"><a href="Agda.Syntax.Literal.html#LitMeta"><span class="hs-identifier hs-type">LitMeta</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Literal
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-type">litString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-857"></span><span id="litString"><span class="annot"><span class="annottext">litString :: Text -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litString"><span class="hs-identifier hs-var hs-var">litString</span></a></span></span><span> </span><span id="local-6989586621680806924"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680806924"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Type -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Ann"><span class="hs-identifier hs-var">HS.Ann</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680806924"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyCon"><span class="hs-identifier hs-var">HS.TyCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ModuleName
</span><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-var">HS.ModuleName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Data.Text&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Text&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-859"></span><span>
</span><span id="line-860"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-type">litqname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Exp"><span class="hs-identifier hs-type">HS.Exp</span></a></span><span>
</span><span id="line-861"></span><span id="litqname"><span class="annot"><span class="annottext">litqname :: QName -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqname"><span class="hs-identifier hs-var hs-var">litqname</span></a></span></span><span> </span><span id="local-6989586621680806920"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806920"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-862"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;QName&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621680806918"><span class="hs-operator hs-var">`apps`</span></a></span><span>
</span><span id="line-863"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806916"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-864"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Exp
forall a. Integral a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedInt"><span class="hs-identifier hs-var">hsTypedInt</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806915"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Lit"><span class="hs-identifier hs-var">HS.Lit</span></a></span><span> </span><span class="annot"><span class="annottext">(Literal -&gt; Exp) -&gt; Literal -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#String"><span class="hs-identifier hs-var">HS.String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Literal) -&gt; Text -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">Text.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806920"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-866"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fixity&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621680806918"><span class="hs-operator hs-var">`apps`</span></a></span><span>
</span><span id="line-867"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Associativity -&gt; Exp
</span><a href="#local-6989586621680806914"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; Associativity
</span><a href="Agda.Syntax.Common.html#fixityAssoc"><span class="hs-identifier hs-var hs-var">fixityAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621680806912"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FixityLevel -&gt; Exp
</span><a href="#local-6989586621680806911"><span class="hs-identifier hs-var">litPrec</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fixity -&gt; FixityLevel
</span><a href="Agda.Syntax.Common.html#fixityLevel"><span class="hs-identifier hs-var hs-var">fixityLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity
</span><a href="#local-6989586621680806912"><span class="hs-identifier hs-var">fx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-872"></span><span>    </span><span id="local-6989586621680806918"><span class="annot"><span class="annottext">apps :: Exp -&gt; [Exp] -&gt; Exp
</span><a href="#local-6989586621680806918"><span class="hs-identifier hs-var hs-var">apps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; Exp -&gt; [Exp] -&gt; Exp
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-identifier hs-var">HS.App</span></a></span><span>
</span><span id="line-873"></span><span>    </span><span id="local-6989586621680806919"><span class="annot"><span class="annottext">rteCon :: String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var hs-var">rteCon</span></a></span></span><span> </span><span id="local-6989586621680806909"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806909"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QName -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#Con"><span class="hs-identifier hs-var">HS.Con</span></a></span><span> </span><span class="annot"><span class="annottext">(QName -&gt; Exp) -&gt; QName -&gt; Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806909"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-874"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span id="local-6989586621680806916"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806916"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680806915"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806915"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameId
</span><a href="Agda.Syntax.Abstract.Name.html#nameId"><span class="hs-identifier hs-var hs-var">nameId</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameId) -&gt; Name -&gt; NameId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806920"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-875"></span><span>    </span><span id="local-6989586621680806912"><span class="annot"><span class="annottext">fx :: Fixity
</span><a href="#local-6989586621680806912"><span class="hs-identifier hs-var hs-var">fx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity' -&gt; Fixity
</span><a href="Agda.Syntax.Common.html#theFixity"><span class="hs-identifier hs-var hs-var">theFixity</span></a></span><span> </span><span class="annot"><span class="annottext">(Fixity' -&gt; Fixity) -&gt; Fixity' -&gt; Fixity
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Fixity'
</span><a href="Agda.Syntax.Abstract.Name.html#nameFixity"><span class="hs-identifier hs-var hs-var">nameFixity</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Fixity') -&gt; Name -&gt; Fixity'
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806920"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-876"></span><span>
</span><span id="line-877"></span><span>    </span><span id="local-6989586621680806914"><span class="annot"><span class="annottext">litAssoc :: Associativity -&gt; Exp
</span><a href="#local-6989586621680806914"><span class="hs-identifier hs-var hs-var">litAssoc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#NonAssoc"><span class="hs-identifier hs-var">NonAssoc</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NonAssoc&quot;</span></span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><a href="#local-6989586621680806914"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#LeftAssoc"><span class="hs-identifier hs-var">LeftAssoc</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LeftAssoc&quot;</span></span><span>
</span><span id="line-879"></span><span>    </span><span class="annot"><a href="#local-6989586621680806914"><span class="hs-identifier hs-var">litAssoc</span></a></span><span> </span><span class="annot"><span class="annottext">Associativity
</span><a href="Agda.Syntax.Common.html#RightAssoc"><span class="hs-identifier hs-var">RightAssoc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RightAssoc&quot;</span></span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span>    </span><span id="local-6989586621680806911"><span class="annot"><span class="annottext">litPrec :: FixityLevel -&gt; Exp
</span><a href="#local-6989586621680806911"><span class="hs-identifier hs-var hs-var">litPrec</span></a></span></span><span> </span><span class="annot"><span class="annottext">FixityLevel
</span><a href="Agda.Syntax.Common.html#Unrelated"><span class="hs-identifier hs-var">Unrelated</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unrelated&quot;</span></span><span>
</span><span id="line-882"></span><span>    </span><span class="annot"><a href="#local-6989586621680806911"><span class="hs-identifier hs-var">litPrec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Syntax.Common.html#Related"><span class="hs-identifier hs-type">Related</span></a></span><span> </span><span id="local-6989586621680806898"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806898"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp
</span><a href="#local-6989586621680806919"><span class="hs-identifier hs-var">rteCon</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Related&quot;</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#App"><span class="hs-operator hs-var">`HS.App`</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Exp
forall a. Real a =&gt; a -&gt; Exp
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsTypedDouble"><span class="hs-identifier hs-var">hsTypedDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680806898"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-type">litqnamepat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Pat"><span class="hs-identifier hs-type">HS.Pat</span></a></span><span>
</span><span id="line-885"></span><span id="litqnamepat"><span class="annot"><span class="annottext">litqnamepat :: QName -&gt; Pat
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#litqnamepat"><span class="hs-identifier hs-var hs-var">litqnamepat</span></a></span></span><span> </span><span id="local-6989586621680806896"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806896"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-886"></span><span>  </span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#Qual"><span class="hs-identifier hs-var">HS.Qual</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#mazRTE"><span class="hs-identifier hs-var">mazRTE</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;QName&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806895"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Literal -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PLit"><span class="hs-identifier hs-var">HS.PLit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Literal
</span><a href="Agda.Utils.Haskell.Syntax.html#Int"><span class="hs-identifier hs-var">HS.Int</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Literal) -&gt; Integer -&gt; Literal
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806894"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PWildCard"><span class="hs-identifier hs-var">HS.PWildCard</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-890"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-891"></span><span>    </span><span class="annot"><a href="Agda.Syntax.Common.html#NameId"><span class="hs-identifier hs-type">NameId</span></a></span><span> </span><span id="local-6989586621680806895"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806895"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680806894"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621680806894"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NameId
</span><a href="Agda.Syntax.Abstract.Name.html#nameId"><span class="hs-identifier hs-var hs-var">nameId</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; NameId) -&gt; Name -&gt; NameId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#qnameName"><span class="hs-identifier hs-var hs-var">qnameName</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806896"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-892"></span><span>
</span><span id="line-893"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-type">condecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Induction"><span class="hs-identifier hs-type">Induction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span>
</span><span id="line-894"></span><span id="condecl"><span class="annot"><span class="annottext">condecl :: QName
-&gt; Induction
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#condecl"><span class="hs-identifier hs-var hs-var">condecl</span></a></span></span><span> </span><span id="local-6989586621680806893"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806893"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680806892"><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621680806892"><span class="hs-identifier hs-var">_ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-895"></span><span>  </span><span id="local-6989586621680806891"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680806891"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Definition
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m Definition
</span><a href="Agda.TypeChecking.Monad.Signature.html#getConstInfo"><span class="hs-identifier hs-var">getConstInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806893"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-896"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">conPars :: Defn -&gt; VerboseLevel
</span><a href="Agda.TypeChecking.Monad.Base.html#conPars"><span class="hs-identifier hs-var">conPars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680806889"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806889"><span class="hs-identifier hs-var">np</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">conErased :: Defn -&gt; Maybe [Bool]
</span><a href="Agda.TypeChecking.Monad.Base.html#conErased"><span class="hs-identifier hs-var">conErased</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680806887"><span class="annot"><span class="annottext">Maybe [Bool]
</span><a href="#local-6989586621680806887"><span class="hs-identifier hs-var">erased</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Defn
</span><a href="Agda.TypeChecking.Monad.Base.html#theDef"><span class="hs-identifier hs-var hs-var">theDef</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680806891"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-897"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680806886"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680806886"><span class="hs-identifier hs-var">argTypes0</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type -&gt; HsCompileM ([Type], Type)
</span><a href="Agda.Compiler.MAlonzo.HaskellTypes.html#hsTelApproximation"><span class="hs-identifier hs-var">hsTelApproximation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Definition -&gt; Type
</span><a href="Agda.TypeChecking.Monad.Base.html#defType"><span class="hs-identifier hs-var hs-var">defType</span></a></span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680806891"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806885"><span class="annot"><span class="annottext">argTypes :: [(Maybe Strictness, Type)]
</span><a href="#local-6989586621680806885"><span class="hs-identifier hs-var hs-var">argTypes</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strictness -&gt; Maybe Strictness
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="Agda.Utils.Haskell.Syntax.html#Lazy"><span class="hs-identifier hs-var">HS.Lazy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680806883"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>                     </span><span class="hs-comment">-- Currently all constructors are lazy.</span><span>
</span><span id="line-900"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680806883"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680806883"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Bool] -&gt; [(Type, Bool)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerboseLevel -&gt; [Type] -&gt; [Type]
forall a. VerboseLevel -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806889"><span class="hs-identifier hs-var">np</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621680806886"><span class="hs-identifier hs-var">argTypes0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Bool] -&gt; Maybe [Bool] -&gt; [Bool]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe [Bool]
</span><a href="#local-6989586621680806887"><span class="hs-identifier hs-var">erased</span></a></span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; [Bool] -&gt; [Bool]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [Bool]
forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>                   </span><span class="hs-special">]</span><span>
</span><span id="line-903"></span><span>  </span><span class="annot"><span class="annottext">ConDecl -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ConDecl
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl)
-&gt; ConDecl
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) ConDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [(Maybe Strictness, Type)] -&gt; ConDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-var">HS.ConDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;C&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806893"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Maybe Strictness, Type)]
</span><a href="#local-6989586621680806885"><span class="hs-identifier hs-var">argTypes</span></a></span><span>
</span><span id="line-904"></span><span>
</span><span id="line-905"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-type">compiledcondecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#HsCompileM"><span class="hs-identifier hs-type">HsCompileM</span></a></span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-906"></span><span id="compiledcondecl"><span class="annot"><span class="annottext">compiledcondecl :: QName -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledcondecl"><span class="hs-identifier hs-var hs-var">compiledcondecl</span></a></span></span><span> </span><span id="local-6989586621680806880"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806880"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-907"></span><span>  </span><span id="local-6989586621680806879"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806879"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCM VerboseLevel
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) VerboseLevel
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM VerboseLevel
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) VerboseLevel)
-&gt; TCM VerboseLevel
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) VerboseLevel
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCM VerboseLevel
forall (m :: * -&gt; *). HasConstInfo m =&gt; QName -&gt; m VerboseLevel
</span><a href="Agda.Compiler.MAlonzo.Coerce.html#erasedArity"><span class="hs-identifier hs-var">erasedArity</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806880"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-908"></span><span>  </span><span id="local-6989586621680806878"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806878"><span class="hs-identifier hs-var">hsCon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TCMT IO String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) String
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCMT IO String
 -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) String)
-&gt; TCMT IO String
-&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; String)
-&gt; TCMT IO (Maybe String) -&gt; TCMT IO String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; TCMT IO (Maybe String)
</span><a href="Agda.Compiler.MAlonzo.Pragmas.html#getHaskellConstructor"><span class="hs-identifier hs-var">getHaskellConstructor</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806880"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-909"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806876"><span class="annot"><span class="annottext">patVars :: [Pat]
</span><a href="#local-6989586621680806876"><span class="hs-identifier hs-var hs-var">patVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(VerboseLevel -&gt; Pat) -&gt; [VerboseLevel] -&gt; [Pat]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; (VerboseLevel -&gt; Name) -&gt; VerboseLevel -&gt; Pat
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806879"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-910"></span><span>  </span><span class="annot"><span class="annottext">Decl -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Decl -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl)
-&gt; Decl -&gt; ReaderT HsModuleEnv (StateT HsCompileState TCM) Decl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pat -&gt; Pat -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#PatSyn"><span class="hs-identifier hs-var">HS.PatSyn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; QName
</span><a href="Agda.Utils.Haskell.Syntax.html#UnQual"><span class="hs-identifier hs-var">HS.UnQual</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QName) -&gt; Name -&gt; QName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;C&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806880"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680806876"><span class="hs-identifier hs-var">patVars</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QName -&gt; [Pat] -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PApp"><span class="hs-identifier hs-var">HS.PApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#hsName"><span class="hs-identifier hs-var">hsName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806878"><span class="hs-identifier hs-var">hsCon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680806876"><span class="hs-identifier hs-var">patVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-type">compiledTypeSynonym</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span>
</span><span id="line-913"></span><span id="compiledTypeSynonym"><span class="annot"><span class="annottext">compiledTypeSynonym :: QName -&gt; String -&gt; VerboseLevel -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#compiledTypeSynonym"><span class="hs-identifier hs-var hs-var">compiledTypeSynonym</span></a></span></span><span> </span><span id="local-6989586621680806874"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806874"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680806873"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806873"><span class="hs-identifier hs-var">hsT</span></a></span></span><span> </span><span id="local-6989586621680806872"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806872"><span class="hs-identifier hs-var">arity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-914"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; [TyVarBind] -&gt; Type -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#TypeDecl"><span class="hs-identifier hs-var">HS.TypeDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;T&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806874"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Name -&gt; TyVarBind) -&gt; [Name] -&gt; [TyVarBind]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; TyVarBind
</span><a href="Agda.Utils.Haskell.Syntax.html#UnkindedVar"><span class="hs-identifier hs-var">HS.UnkindedVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680806871"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyApp"><span class="hs-identifier hs-var">HS.TyApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#FakeType"><span class="hs-identifier hs-var">HS.FakeType</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806873"><span class="hs-identifier hs-var">hsT</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Type] -&gt; Type) -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Type) -&gt; [Name] -&gt; [Type]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type
</span><a href="Agda.Utils.Haskell.Syntax.html#TyVar"><span class="hs-identifier hs-var">HS.TyVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680806871"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-917"></span><span>    </span><span id="local-6989586621680806871"><span class="annot"><span class="annottext">vs :: [Name]
</span><a href="#local-6989586621680806871"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806868"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680806868"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806868"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806872"><span class="hs-identifier hs-var">arity</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-type">tvaldecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span>
</span><span id="line-920"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Induction"><span class="hs-identifier hs-type">Induction</span></a></span><span>
</span><span id="line-921"></span><span>            </span><span class="hs-comment">-- ^ Is the type inductive or coinductive?</span><span>
</span><span id="line-922"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Agda.Syntax.Common.html#Nat"><span class="hs-identifier hs-type">Nat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Agda.Syntax.Internal.html#Clause"><span class="hs-identifier hs-type">Clause</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-923"></span><span id="tvaldecl"><span class="annot"><span class="annottext">tvaldecl :: QName
-&gt; Induction -&gt; VerboseLevel -&gt; [ConDecl] -&gt; Maybe Clause -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#tvaldecl"><span class="hs-identifier hs-var hs-var">tvaldecl</span></a></span></span><span> </span><span id="local-6989586621680806867"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806867"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680806866"><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621680806866"><span class="hs-identifier hs-var">ind</span></a></span></span><span> </span><span id="local-6989586621680806865"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806865"><span class="hs-identifier hs-var">npar</span></a></span></span><span> </span><span id="local-6989586621680806864"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621680806864"><span class="hs-identifier hs-var">cds</span></a></span></span><span> </span><span id="local-6989586621680806863"><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621680806863"><span class="hs-identifier hs-var">cl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="annottext">[Match] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#FunBind"><span class="hs-identifier hs-var">HS.FunBind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [Pat] -&gt; Rhs -&gt; Maybe Binds -&gt; Match
</span><a href="Agda.Utils.Haskell.Syntax.html#Match"><span class="hs-identifier hs-var">HS.Match</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806862"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat]
</span><a href="#local-6989586621680806861"><span class="hs-identifier hs-var">pvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Rhs
</span><a href="Agda.Utils.Haskell.Syntax.html#UnGuardedRhs"><span class="hs-identifier hs-var">HS.UnGuardedRhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="Agda.Utils.Haskell.Syntax.html#unit_con"><span class="hs-identifier hs-var">HS.unit_con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Binds
</span><a href="Agda.Compiler.MAlonzo.Misc.html#emptyBinds"><span class="hs-identifier hs-var">emptyBinds</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span>
</span><span id="line-925"></span><span>  </span><span class="annot"><span class="annottext">[Decl] -&gt; (Clause -&gt; [Decl]) -&gt; Maybe Clause -&gt; [Decl]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">DataOrNew -&gt; Name -&gt; [TyVarBind] -&gt; [ConDecl] -&gt; [Deriving] -&gt; Decl
</span><a href="Agda.Utils.Haskell.Syntax.html#DataDecl"><span class="hs-identifier hs-var">HS.DataDecl</span></a></span><span> </span><span class="annot"><span class="annottext">DataOrNew
</span><a href="#local-6989586621680806858"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806857"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621680806856"><span class="hs-identifier hs-var">cds'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-926"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Decl] -&gt; Clause -&gt; [Decl]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Clause
</span><a href="#local-6989586621680806863"><span class="hs-identifier hs-var">cl</span></a></span><span>
</span><span id="line-927"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680806857"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806857"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680806862"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806862"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;T&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806867"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806867"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-929"></span><span>  </span><span id="local-6989586621680806861"><span class="annot"><span class="annottext">pvs :: [Pat]
</span><a href="#local-6989586621680806861"><span class="hs-identifier hs-var hs-var">pvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Pat
</span><a href="Agda.Utils.Haskell.Syntax.html#PVar"><span class="hs-identifier hs-var">HS.PVar</span></a></span><span>        </span><span class="annot"><span class="annottext">(Name -&gt; Pat) -&gt; Name -&gt; Pat
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; VerboseLevel -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#ihname"><span class="hs-identifier hs-var">ihname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;a&quot;</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806855"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680806855"><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806855"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><a href="#local-6989586621680806865"><span class="hs-identifier hs-var">npar</span></a></span><span> </span><span class="annot"><span class="annottext">VerboseLevel -&gt; VerboseLevel -&gt; VerboseLevel
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">VerboseLevel
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span>  </span><span class="hs-comment">-- Inductive data types consisting of a single constructor with a</span><span>
</span><span id="line-932"></span><span>  </span><span class="hs-comment">-- single argument are translated into newtypes.</span><span>
</span><span id="line-933"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680806858"><span class="annot"><span class="annottext">DataOrNew
</span><a href="#local-6989586621680806858"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680806856"><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621680806856"><span class="hs-identifier hs-var">cds'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="#local-6989586621680806866"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621680806864"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-934"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Induction
</span><a href="Agda.Syntax.Common.html#Inductive"><span class="hs-identifier hs-var">Inductive</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-type">HS.ConDecl</span></a></span><span> </span><span id="local-6989586621680806854"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806854"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Strictness
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680806853"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680806853"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-935"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataOrNew
</span><a href="Agda.Utils.Haskell.Syntax.html#NewType"><span class="hs-identifier hs-var">HS.NewType</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Name -&gt; [(Maybe Strictness, Type)] -&gt; ConDecl
</span><a href="Agda.Utils.Haskell.Syntax.html#ConDecl"><span class="hs-identifier hs-var">HS.ConDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806854"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Strictness
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680806853"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-936"></span><span>      </span><span class="hs-comment">-- The strictness annotations are removed for newtype</span><span>
</span><span id="line-937"></span><span>      </span><span class="hs-comment">-- constructors.</span><span>
</span><span id="line-938"></span><span>    </span><span class="annot"><span class="annottext">(Induction, [ConDecl])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DataOrNew
</span><a href="Agda.Utils.Haskell.Syntax.html#DataType"><span class="hs-identifier hs-var">HS.DataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[ConDecl]
</span><a href="#local-6989586621680806864"><span class="hs-identifier hs-var">cds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>
</span><span id="line-940"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-type">infodecl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Syntax.Abstract.Name.html#QName"><span class="hs-identifier hs-type">QName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Decl"><span class="hs-identifier hs-type">HS.Decl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-941"></span><span id="infodecl"><span class="annot"><span class="annottext">infodecl :: QName -&gt; [Decl] -&gt; [Decl]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var hs-var">infodecl</span></a></span></span><span> </span><span class="annot"><span class="annottext">QName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-942"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#infodecl"><span class="hs-identifier hs-var">infodecl</span></a></span><span> </span><span id="local-6989586621680806850"><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806850"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621680806849"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680806849"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-943"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; String -&gt; Decl
</span><a href="Agda.Compiler.MAlonzo.Misc.html#fakeD"><span class="hs-identifier hs-var">fakeD</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; QName -&gt; Name
</span><a href="Agda.Compiler.MAlonzo.Misc.html#unqhname"><span class="hs-identifier hs-var">unqhname</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806850"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Agda.Utils.String.html#haskellStringLiteral"><span class="hs-identifier hs-var">haskellStringLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">QName
</span><a href="#local-6989586621680806850"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Decl -&gt; [Decl] -&gt; [Decl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680806849"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-946"></span><span class="hs-comment">-- Writing out a haskell module</span><span>
</span><span id="line-947"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="hs-keyword">type</span><span> </span><span id="MonadGHCIO"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-var">MonadGHCIO</span></a></span></span><span> </span><span id="local-6989586621680806846"><span class="annot"><a href="#local-6989586621680806846"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621680806846"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#ReadGHCOpts"><span class="hs-identifier hs-type">ReadGHCOpts</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680806846"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span id="local-6989586621680808089"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-type">copyRTEModules</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680808089"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680808089"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-952"></span><span id="copyRTEModules"><span class="annot"><span class="annottext">copyRTEModules :: m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#copyRTEModules"><span class="hs-identifier hs-var hs-var">copyRTEModules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-953"></span><span>  </span><span id="local-6989586621680806845"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806845"><span class="hs-identifier hs-var">dataDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; m String
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="Paths_Agda.html#getDataDir"><span class="hs-identifier hs-var">getDataDir</span></a></span><span>
</span><span id="line-954"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806843"><span class="annot"><span class="annottext">srcDir :: String
</span><a href="#local-6989586621680806843"><span class="hs-identifier hs-var hs-var">srcDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806845"><span class="hs-identifier hs-var">dataDir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MAlonzo&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;src&quot;</span></span><span>
</span><span id="line-955"></span><span>  </span><span id="local-6989586621680806841"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806841"><span class="hs-identifier hs-var">dstDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcCompileDir"><span class="hs-identifier hs-var hs-var">optGhcCompileDir</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; String) -&gt; m GHCOptions -&gt; m String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-956"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><a href="Agda.Utils.IO.Directory.html#copyDirContent"><span class="hs-identifier hs-var">copyDirContent</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806843"><span class="hs-identifier hs-var">srcDir</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806841"><span class="hs-identifier hs-var">dstDir</span></a></span><span>
</span><span id="line-957"></span><span>
</span><span id="line-958"></span><span id="local-6989586621680808045"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-type">writeModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680808045"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680808045"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-959"></span><span id="writeModule"><span class="annot"><span class="annottext">writeModule :: Module -&gt; m ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#writeModule"><span class="hs-identifier hs-var hs-var">writeModule</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-type">HS.Module</span></a></span><span> </span><span id="local-6989586621680806839"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806839"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680806838"><span class="annot"><span class="annottext">[ModulePragma]
</span><a href="#local-6989586621680806838"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621680806837"><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621680806837"><span class="hs-identifier hs-var">imp</span></a></span></span><span> </span><span id="local-6989586621680806836"><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680806836"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-960"></span><span>  </span><span class="hs-comment">-- Note that GHC assumes that sources use ASCII or UTF-8.</span><span>
</span><span id="line-961"></span><span>  </span><span id="local-6989586621680806835"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806835"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String) -&gt; m (String, String) -&gt; m String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (String, String)
forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m (String, String)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var">outFileAndDir</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806839"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-962"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><a href="Agda.Utils.IO.UTF8.html#writeFile"><span class="hs-identifier hs-var">UTF8.writeFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806835"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Module -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">(Module -&gt; String) -&gt; Module -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-963"></span><span>    </span><span class="annot"><span class="annottext">ModuleName -&gt; [ModulePragma] -&gt; [ImportDecl] -&gt; [Decl] -&gt; Module
</span><a href="Agda.Utils.Haskell.Syntax.html#Module"><span class="hs-identifier hs-var">HS.Module</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806839"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModulePragma
</span><a href="#local-6989586621680806831"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ModulePragma -&gt; [ModulePragma] -&gt; [ModulePragma]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ModulePragma]
</span><a href="#local-6989586621680806838"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621680806837"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">[Decl]
</span><a href="#local-6989586621680806836"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-965"></span><span>  </span><span id="local-6989586621680806831"><span class="annot"><span class="annottext">p :: ModulePragma
</span><a href="#local-6989586621680806831"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; ModulePragma
</span><a href="Agda.Utils.Haskell.Syntax.html#LanguagePragma"><span class="hs-identifier hs-var">HS.LanguagePragma</span></a></span><span> </span><span class="annot"><span class="annottext">([Name] -&gt; ModulePragma) -&gt; [Name] -&gt; ModulePragma
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Name) -&gt; [String] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Name
</span><a href="Agda.Utils.Haskell.Syntax.html#Ident"><span class="hs-identifier hs-var">HS.Ident</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [Name]) -&gt; [String] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-966"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EmptyDataDecls&quot;</span></span><span>
</span><span id="line-967"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EmptyCase&quot;</span></span><span>
</span><span id="line-968"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ExistentialQuantification&quot;</span></span><span>
</span><span id="line-969"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ScopedTypeVariables&quot;</span></span><span>
</span><span id="line-970"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NoMonomorphismRestriction&quot;</span></span><span>
</span><span id="line-971"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RankNTypes&quot;</span></span><span>
</span><span id="line-972"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PatternSynonyms&quot;</span></span><span>
</span><span id="line-973"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;OverloadedStrings&quot;</span></span><span>
</span><span id="line-974"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-975"></span><span>
</span><span id="line-976"></span><span id="local-6989586621680807798"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-type">outFileAndDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807798"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Agda.Utils.Haskell.Syntax.html#ModuleName"><span class="hs-identifier hs-type">HS.ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680807798"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-977"></span><span id="outFileAndDir"><span class="annot"><span class="annottext">outFileAndDir :: ModuleName -&gt; m (String, String)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var hs-var">outFileAndDir</span></a></span></span><span> </span><span id="local-6989586621680806829"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806829"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-978"></span><span>  </span><span id="local-6989586621680806828"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806828"><span class="hs-identifier hs-var">mdir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcCompileDir"><span class="hs-identifier hs-var hs-var">optGhcCompileDir</span></a></span><span> </span><span class="annot"><span class="annottext">(GHCOptions -&gt; String) -&gt; m GHCOptions -&gt; m String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-979"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680806827"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806827"><span class="hs-identifier hs-var">fdir</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680806826"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806826"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><span class="hs-identifier hs-var">splitFileName</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, String)) -&gt; String -&gt; (String, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
</span><a href="#local-6989586621680806824"><span class="hs-identifier hs-var">repldot</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier hs-var">pathSeparator</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-980"></span><span>                   </span><span class="annot"><span class="annottext">ModuleName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806829"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806822"><span class="annot"><span class="annottext">dir :: String
</span><a href="#local-6989586621680806822"><span class="hs-identifier hs-var hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806828"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806827"><span class="hs-identifier hs-var">fdir</span></a></span><span>
</span><span id="line-982"></span><span>      </span><span id="local-6989586621680806821"><span class="annot"><span class="annottext">fp :: String
</span><a href="#local-6989586621680806821"><span class="hs-identifier hs-var hs-var">fp</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806822"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">replaceExtension</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806826"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs&quot;</span></span><span>
</span><span id="line-983"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806822"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-984"></span><span>  </span><span class="annot"><span class="annottext">(String, String) -&gt; m (String, String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806828"><span class="hs-identifier hs-var">mdir</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806821"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-986"></span><span>  </span><span id="local-6989586621680806824"><span class="annot"><span class="annottext">repldot :: Char -&gt; String -&gt; String
</span><a href="#local-6989586621680806824"><span class="hs-identifier hs-var hs-var">repldot</span></a></span></span><span> </span><span id="local-6989586621680806819"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680806819"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">List.map</span></span><span> </span><span class="annot"><span class="annottext">((Char -&gt; Char) -&gt; String -&gt; String)
-&gt; (Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621680806818"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680806818"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680806818"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680806819"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680806818"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span id="local-6989586621680807794"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-type">curOutFileAndDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807794"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadHsModuleEnv"><span class="hs-identifier hs-type">ReadHsModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680807794"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680807794"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-989"></span><span id="curOutFileAndDir"><span class="annot"><span class="annottext">curOutFileAndDir :: m (String, String)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var hs-var">curOutFileAndDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; m (String, String)
forall (m :: * -&gt; *).
MonadGHCIO m =&gt;
ModuleName -&gt; m (String, String)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#outFileAndDir"><span class="hs-identifier hs-var">outFileAndDir</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; m (String, String))
-&gt; m ModuleName -&gt; m (String, String)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m ModuleName
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var">curHsMod</span></a></span><span>
</span><span id="line-990"></span><span>
</span><span id="line-991"></span><span id="local-6989586621680808074"><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-type">curOutFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#MonadGHCIO"><span class="hs-identifier hs-type">MonadGHCIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680808074"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Misc.html#ReadHsModuleEnv"><span class="hs-identifier hs-type">ReadHsModuleEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680808074"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680808074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span></span><span>
</span><span id="line-992"></span><span id="curOutFile"><span class="annot"><span class="annottext">curOutFile :: m String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFile"><span class="hs-identifier hs-var hs-var">curOutFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String) -&gt; m (String, String) -&gt; m String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m (String, String)
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadHsModuleEnv m) =&gt;
m (String, String)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var">curOutFileAndDir</span></a></span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-type">callGHC</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="Agda.Compiler.MAlonzo.Compiler.html#GHCModule"><span class="hs-identifier hs-type">GHCModule</span></a></span><span> </span><span class="annot"><a href="Agda.TypeChecking.Monad.Base.html#TCM"><span class="hs-identifier hs-type">TCM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-995"></span><span id="callGHC"><span class="annot"><span class="annottext">callGHC :: ReaderT GHCModule TCM ()
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#callGHC"><span class="hs-identifier hs-var hs-var">callGHC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-996"></span><span>  </span><span id="local-6989586621680806816"><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621680806816"><span class="hs-identifier hs-var">opts</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM GHCOptions
forall (m :: * -&gt; *). ReadGHCOpts m =&gt; m GHCOptions
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#askGhcOpts"><span class="hs-identifier hs-var">askGhcOpts</span></a></span><span>
</span><span id="line-997"></span><span>  </span><span id="local-6989586621680806815"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806815"><span class="hs-identifier hs-var">hsmod</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Pretty.html#prettyPrint"><span class="hs-identifier hs-var">prettyPrint</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; String)
-&gt; ReaderT GHCModule TCM ModuleName -&gt; ReaderT GHCModule TCM String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ModuleName
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curHsMod"><span class="hs-identifier hs-var">curHsMod</span></a></span><span>
</span><span id="line-998"></span><span>  </span><span id="local-6989586621680806814"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806814"><span class="hs-identifier hs-var">agdaMod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM ModuleName
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m ModuleName
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curAgdaMod"><span class="hs-identifier hs-var">curAgdaMod</span></a></span><span>
</span><span id="line-999"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806812"><span class="annot"><span class="annottext">outputName :: Name
</span><a href="#local-6989586621680806812"><span class="hs-identifier hs-var hs-var">outputName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [Name]
</span><a href="Agda.Syntax.Abstract.Name.html#mnameToList"><span class="hs-identifier hs-var hs-var">mnameToList</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806814"><span class="hs-identifier hs-var">agdaMod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1000"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name
forall a. HasCallStack =&gt; a
</span><a href="Agda.Utils.Impossible.html#__IMPOSSIBLE__"><span class="hs-identifier hs-var">__IMPOSSIBLE__</span></a></span><span>
</span><span id="line-1001"></span><span>        </span><span id="local-6989586621680806810"><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680806810"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Name] -&gt; Name
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621680806810"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-1002"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680806808"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806808"><span class="hs-identifier hs-var">mdir</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680806807"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806807"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM (String, String)
forall (m :: * -&gt; *).
(MonadGHCIO m, ReadHsModuleEnv m) =&gt;
m (String, String)
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#curOutFileAndDir"><span class="hs-identifier hs-var">curOutFileAndDir</span></a></span><span>
</span><span id="line-1003"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806806"><span class="annot"><span class="annottext">ghcopts :: [String]
</span><a href="#local-6989586621680806806"><span class="hs-identifier hs-var hs-var">ghcopts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; [String]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcFlags"><span class="hs-identifier hs-var hs-var">optGhcFlags</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621680806816"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1004"></span><span>
</span><span id="line-1005"></span><span>  </span><span id="local-6989586621680806805"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806805"><span class="hs-identifier hs-var">modIsMain</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM Bool
forall (m :: * -&gt; *). ReadHsModuleEnv m =&gt; m Bool
</span><a href="Agda.Compiler.MAlonzo.Misc.html#curIsMainModule"><span class="hs-identifier hs-var">curIsMainModule</span></a></span><span>
</span><span id="line-1006"></span><span>  </span><span id="local-6989586621680806804"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806804"><span class="hs-identifier hs-var">modHasMainFunc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(GHCModule -&gt; Bool) -&gt; ReaderT GHCModule TCM Bool
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (GHCModule -&gt; Bool) -&gt; GHCModule -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[MainFunctionDef] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">([MainFunctionDef] -&gt; Bool)
-&gt; (GHCModule -&gt; [MainFunctionDef]) -&gt; GHCModule -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GHCModule -&gt; [MainFunctionDef]
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#ghcModMainFuncs"><span class="hs-identifier hs-var hs-var">ghcModMainFuncs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806802"><span class="annot"><span class="annottext">isMain :: Bool
</span><a href="#local-6989586621680806802"><span class="hs-identifier hs-var hs-var">isMain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806805"><span class="hs-identifier hs-var">modIsMain</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806804"><span class="hs-identifier hs-var">modHasMainFunc</span></a></span><span>  </span><span class="hs-comment">-- both need to be IsMain</span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span>  </span><span class="hs-comment">-- Warn if no main function and not --no-main</span><span>
</span><span id="line-1010"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ReaderT GHCModule TCM () -&gt; ReaderT GHCModule TCM ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806805"><span class="hs-identifier hs-var">modIsMain</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806802"><span class="hs-identifier hs-var">isMain</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReaderT GHCModule TCM () -&gt; ReaderT GHCModule TCM ())
-&gt; ReaderT GHCModule TCM () -&gt; ReaderT GHCModule TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1011"></span><span>    </span><span class="annot"><span class="annottext">Doc -&gt; ReaderT GHCModule TCM ()
forall (m :: * -&gt; *). MonadWarning m =&gt; Doc -&gt; m ()
</span><a href="Agda.TypeChecking.Warnings.html#genericWarning"><span class="hs-identifier hs-var">genericWarning</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; ReaderT GHCModule TCM ())
-&gt; ReaderT GHCModule TCM Doc -&gt; ReaderT GHCModule TCM ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModule TCM Doc] -&gt; ReaderT GHCModule TCM Doc
forall (m :: * -&gt; *) (t :: * -&gt; *).
(Applicative m, Foldable t) =&gt;
t (m Doc) -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#fsep"><span class="hs-identifier hs-var">fsep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [ReaderT GHCModule TCM Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No main function defined in&quot;</span></span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModule TCM Doc]
-&gt; [ReaderT GHCModule TCM Doc] -&gt; [ReaderT GHCModule TCM Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ModuleName -&gt; ReaderT GHCModule TCM Doc
forall a (m :: * -&gt; *). (PrettyTCM a, MonadPretty m) =&gt; a -&gt; m Doc
</span><a href="Agda.TypeChecking.Pretty.html#prettyTCM"><span class="hs-identifier hs-var">prettyTCM</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680806814"><span class="hs-identifier hs-var">agdaMod</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM Doc
-&gt; ReaderT GHCModule TCM Doc -&gt; ReaderT GHCModule TCM Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReaderT GHCModule TCM Doc
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[ReaderT GHCModule TCM Doc]
-&gt; [ReaderT GHCModule TCM Doc] -&gt; [ReaderT GHCModule TCM Doc]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1012"></span><span>                             </span><span class="annot"><span class="annottext">String -&gt; [ReaderT GHCModule TCM Doc]
forall (m :: * -&gt; *). Applicative m =&gt; String -&gt; [m Doc]
</span><a href="Agda.TypeChecking.Pretty.html#pwords"><span class="hs-identifier hs-var">pwords</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Use --no-main to suppress this warning.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span>
</span><span id="line-1014"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806799"><span class="annot"><span class="annottext">overridableArgs :: [String]
</span><a href="#local-6989586621680806799"><span class="hs-identifier hs-var hs-var">overridableArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1015"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-O&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1016"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806802"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-o&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806808"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Pretty a =&gt; a -&gt; String
</span><a href="Agda.Utils.Pretty.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Name
</span><a href="Agda.Syntax.Abstract.Name.html#nameConcrete"><span class="hs-identifier hs-var hs-var">nameConcrete</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680806812"><span class="hs-identifier hs-var">outputName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1017"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-Werror&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-1018"></span><span>      </span><span id="local-6989586621680806797"><span class="annot"><span class="annottext">otherArgs :: [String]
</span><a href="#local-6989586621680806797"><span class="hs-identifier hs-var hs-var">otherArgs</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span>
</span><span id="line-1019"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-i&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806808"><span class="hs-identifier hs-var">mdir</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1020"></span><span>        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806802"><span class="hs-identifier hs-var">isMain</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-main-is&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806815"><span class="hs-identifier hs-var">hsmod</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1021"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806807"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-1022"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--make&quot;</span></span><span>
</span><span id="line-1023"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-fwarn-incomplete-patterns&quot;</span></span><span>
</span><span id="line-1024"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-fno-warn-overlapping-patterns&quot;</span></span><span>
</span><span id="line-1025"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1026"></span><span>      </span><span id="local-6989586621680806796"><span class="annot"><span class="annottext">args :: [String]
</span><a href="#local-6989586621680806796"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680806799"><span class="hs-identifier hs-var">overridableArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680806806"><span class="hs-identifier hs-var">ghcopts</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680806797"><span class="hs-identifier hs-var">otherArgs</span></a></span><span>
</span><span id="line-1027"></span><span>
</span><span id="line-1028"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806795"><span class="annot"><span class="annottext">ghcBin :: String
</span><a href="#local-6989586621680806795"><span class="hs-identifier hs-var hs-var">ghcBin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; String
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcBin"><span class="hs-identifier hs-var hs-var">optGhcBin</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621680806816"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1029"></span><span>
</span><span id="line-1030"></span><span>  </span><span class="hs-comment">-- Note: Some versions of GHC use stderr for progress reports. For</span><span>
</span><span id="line-1031"></span><span>  </span><span class="hs-comment">-- those versions of GHC we don't print any progress information</span><span>
</span><span id="line-1032"></span><span>  </span><span class="hs-comment">-- unless an error is encountered.</span><span>
</span><span id="line-1033"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680806794"><span class="annot"><span class="annottext">doCall :: Bool
</span><a href="#local-6989586621680806794"><span class="hs-identifier hs-var hs-var">doCall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GHCOptions -&gt; Bool
</span><a href="Agda.Compiler.MAlonzo.Compiler.html#optGhcCallGhc"><span class="hs-identifier hs-var hs-var">optGhcCallGhc</span></a></span><span> </span><span class="annot"><span class="annottext">GHCOptions
</span><a href="#local-6989586621680806816"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-1034"></span><span>  </span><span class="annot"><span class="annottext">TCM () -&gt; ReaderT GHCModule TCM ()
forall (tcm :: * -&gt; *) a. MonadTCM tcm =&gt; TCM a -&gt; tcm a
</span><a href="Agda.TypeChecking.Monad.Base.html#liftTCM"><span class="hs-identifier hs-var">liftTCM</span></a></span><span> </span><span class="annot"><span class="annottext">(TCM () -&gt; ReaderT GHCModule TCM ())
-&gt; TCM () -&gt; ReaderT GHCModule TCM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; [String] -&gt; TCM ()
</span><a href="Agda.Compiler.CallCompiler.html#callCompiler"><span class="hs-identifier hs-var">callCompiler</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680806794"><span class="hs-identifier hs-var">doCall</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680806795"><span class="hs-identifier hs-var">ghcBin</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680806796"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1035"></span></pre></body></html>